<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="manage">

    <select id="getMemList" parameterType="map" resultType="map">
        /*getClientList*/
        SELECT
            *
        FROM CAM_HR.DJ_EMP_INFO
        WHERE
            (EMP_NAME_KR LIKE CONCAT('%', #{searchValue}, '%') OR ACCOUNT_NUM LIKE CONCAT('%', #{searchValue}, '%') OR RES_REGIS_NUM LIKE CONCAT('%', #{searchValue}, '%'))
    </select>

    <select id="getProjectData" parameterType="map" resultType="map">
        /*getProjectData*/
        SELECT
            A.*,
            DATE_FORMAT(A.REG_DT, '%Y-%m-%d %H:%i') as PJT_REG_DT
        FROM
            CAM_PJT_MNG.DJ_PROJECT A
        WHERE
            A.PJT_CD = #{PJT_CD}
        LIMIT 1
    </select>

    <select id="getEmpInfo" parameterType="map" resultType="map">
        /*getEmpInfo*/
        SELECT
            *
        FROM
            CAM_HR.DJ_EMP_INFO
        WHERE
            EMP_SEQ = #{sn}
    </select>

    <select id="getUserPartRateInfo" parameterType="map" resultType="map">
        /*getUserPartRateInfo*/
        SELECT
            C.PJT_SN,
            A.CHNG_SAL,
            A.MON_SAL,
            A.PART_DET_STR_DT,
            A.PART_DET_END_DT,
            (SELECT LG_CD_NM FROM CAM_PJT_MNG.DJ_PJT_CD WHERE LG_CD = C.SBJ_DEP AND GRP_SN = 'SUP_DEP' LIMIT 1) AS SBJ_DEP_NM,
            C.PJT_NM,
            DATE_FORMAT(C.END_DT, '%Y-%m-%d') AS PJT_END_DT,
            C.PM_EMP_SEQ,
            C.SBJ_STAT_YN,
            A.TOT_RATE
        FROM
            CAM_PJT_MNG.DJ_PART_RATE_DET A
        LEFT JOIN
            CAM_PJT_MNG.DJ_PJT_PART_RATE_VER B
        ON
            A.PART_RATE_VER_SN = B.PART_RATE_VER_SN
        LEFT JOIN
            CAM_PJT_MNG.DJ_PROJECT C
        ON
            B.PJT_SN = C.PJT_SN
        WHERE
            B.MNG_STAT = 'C'
        AND
            B.BEF_VER_CHECK = 'Y'
        AND
            A.PART_EMP_SEQ = #{empSeq}
        <if test='strDe != null and "".equals(strDe)'>
        <![CDATA[
            AND
                C.STR_DT >= #{strDe}
        ]]>
        </if>

    </select>

    <select id="getUserSalList" parameterType="map" resultType="map">
        /*getUserSalList*/
        SELECT *
        FROM
            CAM_MNG.V_BS_SALARY
        WHERE
            EMP_SEQ = #{empSeq}
        <![CDATA[
        AND
            START_DT <= #{strMonth} AND END_DT >= #{strMonth}
        ]]>
    </select>

</mapper>