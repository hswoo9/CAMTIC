<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="campus">
    <select id="getCodeList" resultType="map" parameterType="map">
        /* campus.getCodeList */
        SELECT
            *
        FROM
            CAMPUS.DJ_CAMPUS_CODE CC
        WHERE
            1=1
        <if test='active != null and active != ""'>
            AND ACTIVE = #{active}
        </if>
        <if test='campusGroupCodeId != null and campusGroupCodeId != ""'>
            AND CAMPUS_GROUP_CODE_ID = #{campusGroupCodeId}
        </if>
    </select>

    <select id="getCodeOne" resultType="map" parameterType="map">
        /* campus.getCodeOne */
        SELECT
            *
        FROM
            CAMPUS.DJ_CAMPUS_CODE CC
        WHERE
            ACTIVE = 'Y'
            <if test='campusCodeId != null and campusCodeId != ""'>
                AND CAMPUS_CODE_ID = #{campusCodeId}
            </if>
            <if test='campusGroupCodeId != null and campusGroupCodeId != ""'>
                AND CAMPUS_GROUP_CODE_ID = #{campusGroupCodeId} AND CAMPUS_DT_CODE = #{pk}
            </if>
    </select>

    <select id="getRealEduTimeYear" resultType="map" parameterType="map">
        /* getRealEduTimeYear */
        SELECT
            IFNULL(SUM(ER.REAL_EDU_TIME), 0) AS REAL_EDU_TIME,
            CAST(IFNULL(SUM(ER.REAL_EDU_TIME), 0) AS CHAR(10)) AS REAL_EDU_TIME2
        FROM
            CAMPUS.DJ_EDU_INFO EI
        LEFT JOIN
            CAMPUS.DJ_EDU_RESULT ER ON EI.EDU_INFO_ID = ER.EDU_INFO_ID
        WHERE
            LEFT(EI.START_DT, 4) = #{eduYear}
        AND EI.EDU_FORM_TYPE = #{eduFormType}
        AND EI.REG_EMP_SEQ = #{empSeq}
        AND ER.MNG_CHECK = 'Y'
    </select>

    <select id="getRealEduTimeStudyWeekly" resultType="map" parameterType="map">
        /* getRealEduTimeStudyWeekly */
        SELECT
            IFNULL(SUM(JOURNAL_TIME), 0) AS REAL_EDU_TIME
        FROM
            CAMPUS.DJ_STUDY_JOURNAL CSJ
        LEFT JOIN
            CAMPUS.DJ_STUDY_USER CSU ON CSJ.STUDY_INFO_SN = CSU.STUDY_INFO_SN
        WHERE
             CSU.STUDY_EMP_SEQ = #{empSeq} AND CSJ.STUDY_EMP_SEQ = #{empSeq}
          AND CSJ.ACTIVE = 'Y'
        AND JOURNAL_DT BETWEEN (SELECT ADDDATE( #{applyDt}, - WEEKDAY(#{applyDt}) + 0 ) AS MONDAY) AND (SELECT ADDDATE( #{applyDt}, - WEEKDAY(#{applyDt}) + 6 ) AS MONDAY)
    </select>

    <select id="getRealEduTimePropagUsertWeekly" resultType="map" parameterType="map">
        /* getRealEduTimePropagUsertWeekly */
        SELECT
            IFNULL(SUM(EDU_USER_TIME), 0) AS REAL_EDU_TIME
        FROM
            CAMPUS.DJ_STUDY_PROPAG CSP
                LEFT JOIN
            CAMPUS.DJ_PROPAG_USER CPU ON CSP.STUDY_INFO_SN = CPU.STUDY_INFO_SN
        WHERE
            CPU.PROPAG_EMP_SEQ = #{empSeq}
          AND CSP.ACTIVE = 'Y'
          AND PROPAG_DT BETWEEN (SELECT ADDDATE(#{applyDt}, - WEEKDAY(#{applyDt}) + 0 ) AS MONDAY) AND (SELECT ADDDATE(#{applyDt}, - WEEKDAY(#{applyDt}) + 6 ) AS MONDAY)
          AND CPU.PROPAG_RESULT_DT BETWEEN (SELECT ADDDATE(#{applyDt}, - WEEKDAY(#{applyDt}) + 0 ) AS MONDAY) AND (SELECT ADDDATE(#{applyDt}, - WEEKDAY(#{applyDt}) + 6 ) AS MONDAY)

    </select>

    <select id="getRealEduTimeOjtUserToday" resultType="map" parameterType="map">
        /* getRealEduTimeOjtUserToday */
        SELECT
            IFNULL(SUM(EDU_TIME_HALF), 0) AS REAL_EDU_TIME
        FROM
            CAMPUS.DJ_OJT_RESULT CSP
        LEFT JOIN
            CAMPUS.DJ_OJT_USER CPU ON CSP.STUDY_INFO_SN = CPU.STUDY_INFO_SN AND CSP.OJT_RESULT_SN = CPU.OJT_RESULT_SN
        WHERE
            CPU.OJT_EMP_SEQ = #{empSeq}
          AND CSP.ACTIVE = 'Y'
          AND OJT_DT = #{applyDt}
    </select>

    <select id="getRealEduTimeOjtMngToday" resultType="map" parameterType="map">
        /* getRealEduTimeOjtMngToday */
        SELECT
            IFNULL(SUM(EDU_TIME), 0) AS REAL_EDU_TIME
        FROM
            CAMPUS.DJ_OJT_RESULT CSP
        LEFT JOIN
            CAMPUS.DJ_OJT_USER CPU ON CSP.STUDY_INFO_SN = CPU.STUDY_INFO_SN AND CSP.OJT_RESULT_SN = CPU.OJT_RESULT_SN
        WHERE
            CPU.OJT_EMP_SEQ = #{empSeq}
          AND CSP.ACTIVE = 'Y'
          AND OJT_DT = #{applyDt}
    </select>

    <select id="getRealEduTimePropagMngtWeekly" resultType="map" parameterType="map">
        /* getRealEduTimePropagMngtWeekly */
        SELECT
            IFNULL(SUM(EDU_MNG_TIME), 0) AS REAL_EDU_TIME
        FROM
            CAMPUS.DJ_STUDY_PROPAG CSP
                LEFT JOIN
            CAMPUS.DJ_PROPAG_USER CPU ON CSP.STUDY_INFO_SN = CPU.STUDY_INFO_SN
        WHERE
            CPU.PROPAG_EMP_SEQ = #{empSeq}
          AND CSP.ACTIVE = 'Y'
          AND PROPAG_DT BETWEEN (SELECT ADDDATE(#{applyDt}, - WEEKDAY(#{applyDt}) + 0 ) AS MONDAY) AND (SELECT ADDDATE(#{applyDt}, - WEEKDAY(#{applyDt}) + 6 ) AS MONDAY)
    </select>

    <select id="getRealStudyTimeStudyWeekly" resultType="map" parameterType="map">
        /* getRealStudyTimeStudyWeekly */
        SELECT
            IFNULL(SUM(STUDY_TIME), 0) AS STUDY_TIME
        FROM
            CAMPUS.DJ_STUDY_RESULT_USER
        WHERE
            STUDY_EMP_SEQ = #{empSeq}
          AND JOURNAL_DT BETWEEN (SELECT ADDDATE( #{applyDt}, - WEEKDAY(#{applyDt}) + 0 ) AS MONDAY) AND (SELECT ADDDATE( #{applyDt}, - WEEKDAY(#{applyDt}) + 6 ) AS MONDAY)
    </select>

    <select id="getRealPropagTimeStudyWeekly" resultType="map" parameterType="map">
        /* getRealPropagTimeStudyWeekly */
        SELECT
            IFNULL(SUM(REAL_EDU_TIME), 0) AS STUDY_TIME
        FROM
            CAMPUS.DJ_PROPAG_USER
        WHERE
            PROPAG_EMP_SEQ = #{empSeq}
          AND PROPAG_RESULT_DT BETWEEN (SELECT ADDDATE( #{applyDt}, - WEEKDAY(#{applyDt}) + 0 ) AS MONDAY) AND (SELECT ADDDATE( #{applyDt}, - WEEKDAY(#{applyDt}) + 6 ) AS MONDAY)
    </select>

    <select id="getRealOjtTimeStudyToday" resultType="map" parameterType="map">
        /* getRealOjtTimeStudyToday */
        SELECT
            IFNULL(SUM(REAL_OJT_TIME), 0) AS STUDY_TIME
        FROM
            CAMPUS.DJ_OJT_USER
        WHERE
            OJT_EMP_SEQ = #{empSeq}
        AND OJT_RESULT_DT = #{applyDt}
    </select>

    <select id="getRealOjtOneTimeStudyToday" resultType="map" parameterType="map">
        /* getRealOjtOneTimeStudyToday */
        SELECT
            IFNULL(SUM(REAL_OJT_TIME), 0) AS STUDY_ONE_TIME
        FROM
            CAMPUS.DJ_OJT_USER
        WHERE
            OJT_EMP_SEQ = #{empSeq}
          AND STUDY_INFO_SN = #{studyInfoSn}
    </select>

    <select id="getStudyInfoCountStudyWeekly" resultType="map" parameterType="map">
        /* getStudyInfoCountStudyWeekly */
        SELECT
            COUNT(CSJ.STUDY_INFO_SN) AS studyInfoCount
        FROM
            CAMPUS.DJ_STUDY_JOURNAL CSJ
                LEFT JOIN
            CAMPUS.DJ_STUDY_USER CSU ON CSJ.STUDY_INFO_SN = CSU.STUDY_INFO_SN
        WHERE
             CSU.STUDY_EMP_SEQ = #{empSeq}
          AND CSJ.ACTIVE = 'Y'
          AND JOURNAL_DT BETWEEN (SELECT ADDDATE( #{applyDt}, - WEEKDAY(#{applyDt}) + 0 ) AS MONDAY) AND (SELECT ADDDATE( #{applyDt}, - WEEKDAY(#{applyDt}) + 6 ) AS MONDAY)
    </select>

    <select id="getPropagInfoCountStudyWeekly" resultType="map" parameterType="map">
        /* getPropagInfoCountStudyWeekly */
        SELECT
            COUNT(CSP.STUDY_INFO_SN) AS studyInfoCount
        FROM
            CAMPUS.DJ_STUDY_PROPAG CSP
        LEFT JOIN
            CAMPUS.DJ_PROPAG_USER CPU ON CSP.STUDY_INFO_SN = CPU.STUDY_INFO_SN
        WHERE
            CPU.PROPAG_EMP_SEQ = #{empSeq}
          AND CSP.ACTIVE = 'Y'
          AND PROPAG_DT BETWEEN (SELECT ADDDATE( #{applyDt}, - WEEKDAY(#{applyDt}) + 0 ) AS MONDAY) AND (SELECT ADDDATE( #{applyDt}, - WEEKDAY(#{applyDt}) + 6 ) AS MONDAY)
    </select>

    <select id="getOjtInfoCountStudyToday" resultType="map" parameterType="map">
        /* getOjtInfoCountStudyToday */
        SELECT
            COUNT(CSP.STUDY_INFO_SN) AS studyInfoCount
        FROM
            CAMPUS.DJ_OJT_RESULT CSP
        LEFT JOIN
            CAMPUS.DJ_OJT_USER CPU ON CSP.STUDY_INFO_SN = CPU.STUDY_INFO_SN AND CSP.OJT_RESULT_SN = CPU.OJT_RESULT_SN
        WHERE
            CPU.OJT_EMP_SEQ = #{empSeq}
        AND CSP.ACTIVE = 'Y'
        AND OJT_DT = #{applyDt}
    </select>

    <select id="getRealEduTimePropagWeekly" resultType="map" parameterType="map">
        /* getRealEduTimePropagWeekly */
        SELECT
            IFNULL(SUM(JOURNAL_TIME), 0) AS REAL_EDU_TIME
        FROM
            CAMPUS.DJ_STUDY_JOURNAL CSJ
        LEFT JOIN
            CAMPUS.DJ_STUDY_USER CSU ON CSJ.STUDY_INFO_SN = CSU.STUDY_INFO_SN
        WHERE
            CSJ.STUDY_INFO_SN = #{studyInfoSn}
          AND STUDY_EMP_SEQ = #{empSeq}
          AND CSJ.ACTIVE = 'Y'
          AND JOURNAL_DT BETWEEN (SELECT ADDDATE( #{applyDt}, - WEEKDAY(#{applyDt}) + 0 ) AS MONDAY) AND (SELECT ADDDATE( #{applyDt}, - WEEKDAY(#{applyDt}) + 6 ) AS MONDAY)
    </select>

    <select id="getEduInfoList" resultType="map" parameterType="map">
        /* getEduInfoList */
        SELECT
            RE.*
        FROM
            (
                SELECT
                    @ROWNUM := @ROWNUM + 1 AS ROW_NUM,
                    EI.EDU_INFO_ID,
                    EI.REG_EMP_SEQ,
                    EI.REG_EMP_NAME,
                    EI.EDU_NAME,
                    EI.START_DT,
                    EI.END_DT,
                    EI.DUTY_CLASS,
                    CASE
                        WHEN EI.CARE_LOCATION IS NULL
                        THEN EI.CARE_NAME
                        ELSE EI.CARE_LOCATION
                    END AS CARE_LOCATION,
                    CONCAT('Level. ', EI.LEVEL_ID) AS LEVEL_ID,
                    EI.EDU_FORM_TYPE,
                    EI.STATUS,
                    EI.TERM_TIME,
                    IFNULL(ER.STATUS, 1) AS RES_STATUS,
                    ER.MNG_CHECK,
                    EI.OBJECT_FORUM_TYPE,
                    IFNULL(EI.BOOK_PAGE_VAL, 0) AS BOOK_PAGE_VAL,
                    EI.TREA_UNIT,
                    EI.TREA_TYPE,
                    EI.TREA_USER,
                    EI.BOOK_UNIT,
                    HEI.POSITION_NAME,
                    IFNULL(ER.REAL_EDU_TIME, 0) AS REAL_EDU_TIME
                FROM
                    CAMPUS.DJ_EDU_INFO EI
                LEFT JOIN
                    CAM_HR.DJ_EMP_INFO HEI ON HEI.EMP_SEQ = EI.REG_EMP_SEQ
                LEFT JOIN
                    CAMPUS.DJ_EDU_RESULT ER ON EI.EDU_INFO_ID = ER.EDU_INFO_ID,
                (SELECT @ROWNUM := 0) TMP
                WHERE
                    1=1
                AND
                    EI.ACTIVE='Y'
                <if test='empSeq != null and empSeq != ""'>
                    AND EI.REG_EMP_SEQ = #{empSeq}
                </if>
                <if test='deptComp != null and !"".equals(deptComp)'>
                    AND
                    EI.DEPT_SEQ = #{deptComp}
                    <if test='deptTeam == deptTeam or "".equals(deptTeam)'>
                        OR
                            EI.DEPT_SEQ IN (
                        SELECT
                            DEPT_SEQ
                        FROM
                            CAM_HR.DJ_DEPT_INFO
                        WHERE
                            DEPT_SEQ = #{deptComp}
                        OR
                            PARENT_DEPT_SEQ = #{deptComp}
                        )
                    </if>
                </if>
                <if test='deptTeam != null and !"".equals(deptTeam)'>
                    AND
                        EI.DEPT_SEQ = #{deptTeam}
                </if>
                <if test='studyClass != null and !"".equals(studyClass)'>
                    AND
                       EDU_FORM_TYPE = #{studyClass}
                </if>
                <if test='kindContent != null and !"".equals(kindContent)'>
                    AND
                        EI.REG_EMP_NAME like concat('%', #{kindContent} ,'%')
                </if>
                <if test='status != null and !"".equals(status)'>
                    AND
                        EI.STATUS = #{status}
                </if>
                <if test='mngCheck != null and !"".equals(mngCheck)'>
                    AND
                        ER.MNG_CHECK = #{mngCheck}
                </if>
                <if test='position != null and !"".equals(position)'>
                    AND
                        HEI.POSITION_NAME = #{position}
                </if>
                <if test='duty != null and !"".equals(duty)'>
                    AND
                        HEI.POSITION_NAME = #{duty}
                </if>
                AND (DATE_FORMAT(EI.START_DT, '%Y') = #{eduYear})
                ORDER BY EI.EDU_INFO_ID
            ) RE
            <if test='resStatus != null and !"".equals(resStatus)'>
                WHERE
                    RE.RES_STATUS = #{resStatus}
            </if>
        ORDER BY RE.EDU_INFO_ID DESC
    </select>

    <select id="getEduResponsableList" resultType="map" parameterType="map">
    /* getEduResponsableList */
        SELECT
            VEI.EMP_SEQ,
            VEI.EMP_NAME_KR,
            VEI.LOGIN_ID,
            VEI.DEPT_SEQ,
            (SELECT DEPT_NAME FROM CAM_HR.DJ_DEPT_INFO WHERE DEPT_SEQ = (SELECT PARENT_DEPT_SEQ FROM CAM_HR.DJ_DEPT_INFO WHERE DEPT_SEQ = VEI.DEPT_SEQ)) AS PARENT_DEPT_NAME,
            (SELECT DEPT_NAME FROM CAM_HR.DJ_DEPT_INFO DI WHERE DEPT_SEQ = VEI.DEPT_SEQ) AS DEPT_NAME,
            VEI.MOBILE_TEL_NUM,
            VEI.OFFICE_TEL_NUM,
            VEI.POSITION_CODE,
            IFNULL(VEI.POSITION_NAME, '') AS POSITION_NAME,
            (SELECT CONCAT(VEI.EMP_NAME_KR, ' ', COALESCE(VEI.POSITION_NAME, ''))) AS NAME_POSITION_TXT,
            VEI.DUTY_CODE,
            IFNULL(VEI.DUTY_NAME, '') AS DUTY_NAME,
            VEI.JOB_DETAIL,
            CASE WHEN VEI.DUTY_CODE IS NOT NULL THEN (SELECT SORT FROM CAM_COMMON.dj_com_code WHERE CM_GROUP_CODE_ID = 3 AND CM_CODE = VEI.DUTY_CODE)
                 WHEN VEI.POSITION_CODE IS NOT NULL THEN (SELECT SORT FROM CAM_COMMON.dj_com_code WHERE CM_GROUP_CODE_ID = 4 AND CM_CODE = VEI.POSITION_CODE)
                 ELSE 999 END SORT
        FROM
            CAM_HR.DJ_EMP_INFO VEI
        WHERE
            1 = 1
          AND VEI.ACTIVE = 'Y'
          AND ((DIVISION = 0 OR (DIVISION = 4 AND DIVISION_SUB != 3))
            OR (DIVISION IN(1) AND DIVISION_SUB IN(6))
            OR (DIVISION IN(1) AND DIVISION_SUB IN(6))
            OR (DIVISION IN(4) AND DIVISION_SUB IN(3))
            )
          AND WORK_STATUS_CODE = 'Y'
          AND VEI.DEPT_SEQ = '1228'
        ORDER BY DUTY_CODE DESC, EMP_NAME_KR ASC
    </select>

    <update id="setEduInfoDelete" parameterType="map">
        /* setEduInfoDelete */
        UPDATE
            CAMPUS.DJ_EDU_INFO
        SET
            ACTIVE = 'N'
        WHERE
            EDU_INFO_ID = #{pk}
    </update>

    <update id="setOpenStudyInfoDelete" parameterType="map">
        /* setOpenStudyInfoDelete */
        UPDATE
            CAMPUS.DJ_OPENSTUDY_INFO
        SET
            ACTIVE = 'N'
        WHERE
            OPEN_STUDY_INFO_SN = #{pk}
    </update>

    <update id="setStudyInfoDelete" parameterType="map">
        /* setStudyInfoDelete */
        UPDATE
            CAMPUS.DJ_STUDY_INFO
        SET
            ACTIVE='N'
        WHERE
            STUDY_INFO_SN = #{pk}
    </update>

    <select id="getEduInfoOne" resultType="map" parameterType="map">
        /* getEduInfoOne */
        SELECT
            EI.*,
            DI.DOC_MENU_CD,
            DI.APPRO_KEY,
            p.PJT_NM
        FROM
            CAMPUS.DJ_EDU_INFO EI
        LEFT JOIN DJ_CAMTIC.A_DOC_INFO DI ON DI.DOC_ID = EI.DOC_ID
        LEFT JOIN CAM_PJT_MNG.DJ_PROJECT P ON EI.PJT_SN = P.PJT_SN
        WHERE
            EI.EDU_INFO_ID = #{eduInfoId}
    </select>

    <select id="getEduResultOne" resultType="map" parameterType="map">
        /* getEduResultOne */
        SELECT
            EI.REG_EMP_SEQ,
            EI.EDU_INFO_ID,
            EI.EDU_CATEGORY_DETAIL_ID,
            EI.EDU_CATEGORY_DETAIL_NAME,
            EI.LEVEL_ID,
            IFNULL(ER.EDU_NAME, EI.EDU_NAME) AS EDU_NAME,
            IFNULL(ER.EDU_OBJECT, EI.EDU_OBJECT) AS EDU_OBJECT,
            IFNULL(ER.EDU_CONTENT, EI.EDU_CONTENT) AS EDU_CONTENT,
            IFNULL(ER.START_DT,EI.START_DT) AS START_DT,
            IFNULL(ER.END_DT, EI.END_DT) AS END_DT,
            IFNULL(ER.TERM_DAY,EI.TERM_DAY) AS TERM_DAY,
            IFNULL(ER.TERM_TIME,EI.TERM_TIME) AS TERM_TIME,
            IFNULL(ER.CARE_NAME, EI.CARE_NAME) AS CARE_NAME,
            IFNULL(ER.CARE_LOCATION, EI.CARE_LOCATION) AS CARE_LOCATION,
            EI.CARE_TEL_NUM,
            EI.EDU_MONEY,
            EI.EDU_MONEY_TYPE,
            EI.RETURN_MONEY,
            EI.RETURN_DOC,
            EI.STATUS,
            EI.ATTACH_DOC_NAME,
            EI.FILE_SN,
            EI.REG_DT,
            EI.EDU_FORM_TYPE,
            IFNULL(ER.OBJECT_FORUM_TYPE,EI.OBJECT_FORUM_TYPE) AS OBJECT_FORUM_TYPE,
            IFNULL(ER.OBJECT_FORUM_VAL,EI.OBJECT_FORUM_VAL) AS OBJECT_FORUM_VAL,
            EI.BOOK_WRITER_NAME,
            IFNULL(ER.BOOK_PAGE_VAL,EI.BOOK_PAGE_VAL) AS BOOK_PAGE_VAL,
            IFNULL(ER.BOOK_PULISH_NAME,EI.BOOK_PULISH_NAME) AS BOOK_PULISH_NAME,
            IFNULL(ER.TREA_ORIGIN,EI.TREA_ORIGIN) AS TREA_ORIGIN,
            IFNULL(ER.TREA_UNIT,EI.TREA_UNIT) AS TREA_UNIT,
            IFNULL(ER.TREA_TYPE,EI.TREA_TYPE) AS TREA_TYPE,
            IFNULL(ER.TREA_USER,EI.TREA_USER) AS TREA_USER,
            IFNULL(ER.BOOK_UNIT,EI.BOOK_UNIT) AS BOOK_UNIT,
            IFNULL(ER.COMP_TYPE,EI.COMP_TYPE) AS COMP_TYPE,
            ER.EDU_TEACHER_NAME,
            ER.EDU_EVAL,
            ER.EDU_POINT,
            ER.FBLIST,
            EP.DUTY_CLASS,
            IFNULL(ER.STATUS, 1) AS RES_STATUS,
            ER.EDU_RESULT_ID,
            CC.CAMPUS_DT_CODE_NM AS EDU_FORM_NAME,
            HEI.EMP_NAME_KR,
            CASE WHEN HDI.DEPT_LEVEL = 2 THEN (SELECT DEPT_NAME FROM CAM_HR.DJ_DEPT_INFO DI WHERE HDI.PARENT_DEPT_SEQ = DI.DEPT_SEQ) ELSE HEI.DEPT_NAME END AS DEPT_NAME,
            HEI.DEPT_TEAM_NAME,
            HEI.POSITION_NAME,
            HEI.JOB_DETAIL,
            DI.DOC_ID,
            DI.APPRO_KEY,
            DI.DOC_MENU_CD,
            RDI.DOC_ID AS RES_DOC_ID,
            RDI.APPRO_KEY AS RES_APPRO_KEY,
            RDI.DOC_MENU_CD AS RES_DOC_MENU_CD,
            EP.EDU_PLAN,
            ER.MNG_CHECK,
            IFNULL(ER.REAL_EDU_TIME, 0) AS REAL_EDU_TIME,
            ECD.EDU_CATEGORY_NAME,
            EI.PURC_TYPE,
            p.PJT_NM
        FROM
            CAMPUS.DJ_EDU_INFO EI
        LEFT JOIN
            CAMPUS.DJ_EDU_RESULT ER ON EI.EDU_INFO_ID = ER.EDU_INFO_ID
        LEFT JOIN
            CAMPUS.DJ_CAMPUS_CODE CC ON EI.EDU_FORM_TYPE = CC.CAMPUS_DT_CODE AND CC.CAMPUS_MD_CODE = 03
        LEFT JOIN
            CAMPUS.DJ_EDU_CATEGORY_DETAIL ECD ON EI.EDU_CATEGORY_DETAIL_ID = ECD.EDU_CATEGORY_DETAIL_ID
        LEFT JOIN
            CAMPUS.DJ_EDU_PLAN EP ON ECD.EDU_CATEGORY_ID = EP.EDU_CATEGORY_ID AND EI.DUTY_CLASS = EP.DUTY_CLASS AND EI.REG_EMP_SEQ = EP.REG_EMP_SEQ AND DATE_FORMAT(EI.REG_DT, '%Y') = EP.TARGET_YEAR
        LEFT JOIN
            CAM_HR.DJ_EMP_INFO HEI ON HEI.EMP_SEQ = EI.REG_EMP_SEQ
        LEFT JOIN
            DJ_CAMTIC.A_DOC_INFO DI ON DI.DOC_ID = EI.DOC_ID
        LEFT JOIN
            DJ_CAMTIC.A_DOC_INFO RDI ON RDI.DOC_ID = ER.DOC_ID
        LEFT JOIN
            CAM_HR.DJ_DEPT_INFO HDI ON HEI.DEPT_SEQ = HDI.DEPT_SEQ
        LEFT JOIN
            CAM_PJT_MNG.DJ_PROJECT P ON EI.PJT_SN = P.PJT_SN
        WHERE
            EI.EDU_INFO_ID = #{eduInfoId}
    </select>

    <select id="getTargetYearList" resultType="map" parameterType="map">
        /* getTargetYearList */
        SELECT
            CONCAT(ET.TARGET_YEAR, '년') AS TEXT,
            ET.TARGET_YEAR AS VALUE
        FROM
            CAMPUS.DJ_EDU_TARGET ET
        WHERE
            ET.REG_EMP_SEQ = #{empSeq}
        GROUP BY VALUE
        ORDER BY EDU_TARGET_ID DESC
    </select>

    <select id="getTargetOne" resultType="map" parameterType="map">
        /* getTargetOne */
        SELECT
            EDU_TARGET_ID,
            TARGET_YEAR,
            TARGET_CODE,
            LOGIN_ID,
            STATUS,
            LD_STAT,
            MNG_STAT,
            REG_EMP_SEQ,
            REG_DATE
        FROM
            CAMPUS.DJ_EDU_TARGET ET
        WHERE
            TARGET_YEAR = #{targetYear}
        AND REG_EMP_SEQ = #{empSeq}
    </select>

    <select id="getTargetList" resultType="map" parameterType="map">
        /* getTargetList */
        SELECT
            ETD.EDU_TARGET_DETAIL_ID,
            ETD.EDU_TARGET_ID,
            ET.TARGET_YEAR,
            ET.TARGET_CODE,
            ET.LOGIN_ID,
            ETD.EDU_CATEGORY_DETAIL_ID,
            ETD.TARGET_CLASS,
            ETD.DUTY_CLASS,
            ETD.STATUS
        FROM
            CAMPUS.DJ_EDU_TARGET ET
        LEFT JOIN
            CAMPUS.DJ_EDU_TARGET_DETAIL ETD ON ET.EDU_TARGET_ID = ETD.EDU_TARGET_ID
        WHERE
            ET.TARGET_YEAR = #{targetYear}
        AND ET.REG_EMP_SEQ = #{empSeq}
        <if test='dutyClass != null and dutyClass != ""'>
            AND ETD.DUTY_CLASS = #{dutyClass}
        </if>
    </select>

    <select id="getEduCategoryOne" resultType="map" parameterType="map">
        /* getEduCategoryOne */
        SELECT
            EC.EDU_CATEGORY_ID,
            EC.EDU_CATEGORY_NAME
        FROM
            CAMPUS.DJ_EDU_CATEGORY EC
        WHERE
            EC.EDU_CATEGORY_ID = #{pk}
    </select>

    <select id="getEduCategoryList" resultType="map" parameterType="map">
        /* getEduCategoryList */
        SELECT
            EC.EDU_CATEGORY_ID,
            EC.EDU_CATEGORY_NAME,
            EC.LARGE_CATEGORY_ID,
            EC.LARGE_CATEGORY_NAME,
            EC.ACTIVE
        FROM
            CAMPUS.DJ_EDU_CATEGORY EC
        WHERE
            1=1
        <if test='largeCategoryId != null and largeCategoryId != ""'>
            AND EC.LARGE_CATEGORY_ID in (${largeCategoryId})
        </if>
        ORDER BY EC.LARGE_CATEGORY_ID, EC.ORDER
    </select>

    <select id="getEduCategoryDetailOne" resultType="map" parameterType="map">
        /* getEduCategoryDetailOne */
        SELECT
            ECD.EDU_CATEGORY_DETAIL_ID,
            ECD.EDU_CATEGORY_DETAIL_NAME,
            ECD.LEVEL_ID,
            ECD.LEVEL_NAME
        FROM
            CAMPUS.DJ_EDU_CATEGORY_DETAIL ECD
        WHERE
            ECD.EDU_CATEGORY_DETAIL_ID = #{pk}
    </select>

    <select id="getEduCategoryDetailList" resultType="map" parameterType="map">
        /* getEduCategoryDetailList */
        SELECT
            ECD.EDU_CATEGORY_DETAIL_ID,
            ECD.EDU_CATEGORY_DETAIL_NAME,
            ECD.EDU_CATEGORY_ID,
            ECD.EDU_CATEGORY_NAME,
            ECD.LEVEL_ID,
            ECD.LEVEL_NAME,
            ECD.ACTIVE
        FROM
            CAMPUS.DJ_EDU_CATEGORY_DETAIL ECD
        WHERE
            1=1
        <if test='levelId != null and levelId != ""'>
            AND ECD.LEVEL_ID = #{levelId}
        </if>
        <if test='eduCategoryId != null and eduCategoryId != ""'>
            AND ECD.EDU_CATEGORY_ID in (${eduCategoryId})
        </if>
        ORDER BY ECD.ORDER
    </select>

    <select id="getTargetCategoryList" resultType="map" parameterType="map">
        /* getTargetCategoryList */
        SELECT
            EC.EDU_CATEGORY_ID,
            EC.EDU_CATEGORY_NAME
        FROM
            CAMPUS.DJ_EDU_CATEGORY EC
        WHERE
            EC.EDU_CATEGORY_ID IN (
                SELECT
                    EDU_CATEGORY_ID
                FROM
                    CAMPUS.DJ_EDU_TARGET ET
                LEFT JOIN
                    CAMPUS.DJ_EDU_TARGET_DETAIL ETD ON ET.EDU_TARGET_ID = ETD.EDU_TARGET_ID
                LEFT JOIN
                    CAMPUS.DJ_EDU_CATEGORY_DETAIL ECD ON ETD.EDU_CATEGORY_DETAIL_ID = ECD.EDU_CATEGORY_DETAIL_ID
                WHERE
                    ET.TARGET_YEAR = #{targetYear}
                AND ET.REG_EMP_SEQ = #{empSeq}
                <if test='dutyClass != null and dutyClass != ""'>
                    AND ETD.DUTY_CLASS = #{dutyClass}
                </if>
            )
    </select>

    <select id="getTargetCategoryDetailList" resultType="map" parameterType="map">
        /* getTargetCategoryDetailList */
        SELECT
            ETD.EDU_TARGET_DETAIL_ID,
            ETD.TARGET_CLASS,
            ECD.EDU_CATEGORY_ID,
            ECD.EDU_CATEGORY_DETAIL_ID,
            ECD.EDU_CATEGORY_DETAIL_NAME,
            ECD.LEVEL_ID,
            ETD.STATUS
        FROM
            CAMPUS.DJ_EDU_TARGET ET
        LEFT JOIN
            CAMPUS.DJ_EDU_TARGET_DETAIL ETD ON ET.EDU_TARGET_ID = ETD.EDU_TARGET_ID
        LEFT JOIN
            CAMPUS.DJ_EDU_CATEGORY_DETAIL ECD ON ETD.EDU_CATEGORY_DETAIL_ID = ECD.EDU_CATEGORY_DETAIL_ID
        WHERE
            ET.TARGET_YEAR = #{targetYear}
        AND
            ET.REG_EMP_SEQ = #{empSeq}
        <if test='dutyClass != null and dutyClass != ""'>
            AND ETD.DUTY_CLASS = #{dutyClass}
        </if>
    </select>

    <select id="getEduPlanList" resultType="map" parameterType="map">
        /* getEduPlanList */
        SELECT
            EP.EDU_PLAN_ID,
            EP.EDU_CATEGORY_ID,
            EP.EDU_PLAN
        FROM
            CAMPUS.DJ_EDU_PLAN EP
        WHERE
            TARGET_YEAR = #{targetYear}
        AND REG_EMP_SEQ = #{empSeq}
        AND DUTY_CLASS = #{dutyClass}
    </select>

    <select id="getEduPlanOne" resultType="map" parameterType="map">
        /* getEduPlanOne */
        SELECT
            EP.EDU_PLAN_ID,
            EP.EDU_PLAN
        FROM
            CAMPUS.DJ_EDU_PLAN EP
        WHERE
            EDU_CATEGORY_ID = #{eduCategoryId}
        AND TARGET_YEAR = #{targetYear}
        AND DUTY_CLASS = #{dutyClass}
        AND REG_EMP_SEQ = #{empSeq}
    </select>

    <select id="getStudyInfoStatList" resultType="map" parameterType="map">
        /* getStudyInfoStatList */
        SELECT
            CSU.STUDY_EMP_SEQ,
            CSI.*,
            IFNULL((SELECT SUM(SCSJ.JOURNAL_TIME) FROM CAMPUS.DJ_STUDY_JOURNAL SCSJ LEFT JOIN CAMPUS.DJ_STUDY_USER SCSU ON SCSJ.STUDY_INFO_SN = SCSU.STUDY_INFO_SN WHERE SCSJ.STUDY_INFO_SN = CSI.STUDY_INFO_SN AND SCSU.STUDY_EMP_SEQ = #{empSeq} AND SCSJ.ACTIVE = 'Y' AND CAPTAIN_APPOVAL_YN = 'Y'), 0) AS STUDY_TIME,
            IFNULL((SELECT SUM(SCSI.EDU_TIME) FROM CAMPUS.DJ_STUDY_INFO SCSI LEFT JOIN CAMPUS.DJ_STUDY_USER SCSU ON SCSI.STUDY_INFO_SN = SCSU.STUDY_INFO_SN WHERE SCSU.STUDY_INFO_SN = CSI.STUDY_INFO_SN AND SCSU.STUDY_EMP_SEQ = #{empSeq} AND SCSI.STATUS = '100' AND SCSI.STUDY_CLASS_SN = 2), 0) AS PROPAG_TIME,
            IFNULL((SELECT SUM(SCOR.EDU_FULL_TIME) FROM CAMPUS.DJ_STUDY_INFO SCSI LEFT JOIN CAMPUS.DJ_OJT_RESULT SCOR ON SCOR.STUDY_INFO_SN = SCSI.STUDY_INFO_SN LEFT JOIN CAMPUS.DJ_OJT_USER SCOU ON SCOR.OJT_RESULT_SN = SCOU.OJT_RESULT_SN WHERE SCOR.STUDY_INFO_SN = CSI.STUDY_INFO_SN AND SCOU.OJT_EMP_SEQ = #{empSeq} AND (SCSI.STATUS = '101' OR SCSI.STATUS = '100') AND SCSI.ACTIVE = 'Y'), 0) AS OJT_TIME,
            IFNULL((SELECT SUM(STUDY_TIME) FROM CAMPUS.DJ_STUDY_RESULT_USER WHERE STUDY_INFO_SN = CSI.STUDY_INFO_SN AND STUDY_EMP_SEQ = #{empSeq} GROUP BY STUDY_EMP_SEQ), 0) as REAL_STUDY_TIME,
            IFNULL((SELECT SUM(EDU_TIME) FROM CAMPUS.DJ_STUDY_PROPAG WHERE STUDY_INFO_SN = CSI.STUDY_INFO_SN), 0) AS PROPAG_SUM,
            IFNULL((SELECT SUM(EDU_MNG_TIME) FROM CAMPUS.DJ_STUDY_PROPAG WHERE STUDY_INFO_SN = CSI.STUDY_INFO_SN), 0) AS PROPAG_MNG_SUM,
            IFNULL((SELECT SUM(REAL_EDU_TIME) FROM CAMPUS.DJ_PROPAG_USER WHERE STUDY_INFO_SN = CSI.STUDY_INFO_SN AND PROPAG_EMP_SEQ = #{empSeq} GROUP BY PROPAG_EMP_SEQ), 0) AS REAL_PROPAG_TIME,
            (SELECT STUDY_EMP_NAME FROM CAMPUS.DJ_STUDY_RESULT_USER WHERE STUDY_INFO_SN = CSI.STUDY_INFO_SN AND STUDY_CLASS_SN = 1 LIMIT 1) AS LEADER_NAME,
            (SELECT PROPAG_EMP_NAME FROM CAMPUS.DJ_PROPAG_USER WHERE STUDY_INFO_SN = CSI.STUDY_INFO_SN AND PROPAG_CLASS_SN = 4 LIMIT 1) AS PROPAG_LEADER_NAME,
            (SELECT OJT_EMP_NAME FROM CAMPUS.DJ_OJT_USER WHERE STUDY_INFO_SN = CSI.STUDY_INFO_SN AND OJT_CLASS_SN = 4 LIMIT 1) AS OJT_LEADER_NAME,
            -- 학습조 결과보고
            (SELECT STUDY_RESULT_SN FROM CAMPUS.DJ_STUDY_RESULT WHERE STUDY_INFO_SN = CSI.STUDY_INFO_SN) AS STUDY_RESULT_SN,
            IFNULL((SELECT STATUS FROM CAMPUS.DJ_STUDY_RESULT WHERE STUDY_INFO_SN = CSI.STUDY_INFO_SN), 0) AS STUDY_RES_STATUS,
            -- OJT 인정시간
            IFNULL((SELECT SUM(REAL_OJT_TIME) FROM CAMPUS.DJ_OJT_USER WHERE STUDY_INFO_SN = CSI.STUDY_INFO_SN AND OJT_EMP_SEQ = CSU.STUDY_EMP_SEQ), 0) AS REAL_OJT_TIME
        FROM
            CAMPUS.DJ_STUDY_INFO CSI
        LEFT JOIN
            CAMPUS.DJ_STUDY_USER CSU ON CSI.STUDY_INFO_SN = CSU.STUDY_INFO_SN
        WHERE
            CSU.STUDY_EMP_SEQ = #{empSeq}
        AND CSI.STUDY_CLASS_SN IN(${studyClassSn})
        AND DATE_FORMAT(START_DT, '%Y') = #{eduYear}
        ORDER BY STUDY_INFO_SN DESC
    </select>

    <select id="getStudyInfoList" resultType="map" parameterType="map">
        /* getStudyInfoList */
        SELECT
            @ROWNUM := @ROWNUM + 1 AS ROW_NUM,
            RE.*
        FROM
            (
                SELECT
                    CSI.*,
                    IFNULL((SELECT SUM(JOURNAL_TIME) FROM CAMPUS.DJ_STUDY_JOURNAL SCSJ WHERE CSI.STUDY_INFO_SN = SCSJ.STUDY_INFO_SN AND CAPTAIN_APPOVAL_YN = 'Y'), 0) AS EDU_TIME_TOTAL,
                    (SELECT COUNT(*) FROM CAMPUS.DJ_OJT_RESULT WHERE STUDY_INFO_SN = CSI.STUDY_INFO_SN) as ST_CNT,
                    (SELECT SUM(EDU_FULL_TIME) FROM CAMPUS.DJ_OJT_RESULT WHERE STUDY_INFO_SN = CSI.STUDY_INFO_SN) as ST_SUM,
                    (SELECT STUDY_EMP_NAME FROM CAMPUS.DJ_STUDY_USER WHERE STUDY_INFO_SN = CSI.STUDY_INFO_SN AND STUDY_CLASS_SN = 4 LIMIT 1) as OJT_READER,
                    (SELECT STUDY_EMP_NAME FROM CAMPUS.DJ_STUDY_USER WHERE STUDY_INFO_SN = CSI.STUDY_INFO_SN AND STUDY_CLASS_SN = 1 LIMIT 1) as STUDY_READER,
                    (SELECT SUM(EDU_TIME) FROM CAMPUS.DJ_STUDY_PROPAG WHERE STUDY_INFO_SN = CSI.STUDY_INFO_SN) AS PROPAG_SUM,
                    (SELECT COUNT(*) FROM CAMPUS.DJ_STUDY_USER WHERE STUDY_INFO_SN = CSI.STUDY_INFO_SN) - 1 AS COUNT_STUDY_MEMBER,
                    IFNULL((SELECT SUM(STUDY_TIME) FROM CAMPUS.DJ_STUDY_RESULT_USER SRU
                        LEFT JOIN CAMPUS.DJ_STUDY_JOURNAL SJ ON SJ.STUDY_JOURNAL_SN = SRU.STUDY_JOURNAL_SN
                        LEFT JOIN CAMPUS.DJ_STUDY_INFO SSI ON SJ.STUDY_INFO_SN = SSI.STUDY_INFO_SN
                        WHERE SRU.STUDY_INFO_SN = CSI.STUDY_INFO_SN  AND SJ.ACTIVE = 'Y' AND SSI.ADD_STATUS = 'S' AND SRU.STUDY_EMP_SEQ = #{empSeq} GROUP BY SRU.STUDY_EMP_SEQ
                    ), 0) AS STUDY_TIME,
                    IFNULL((SELECT SUM(REAL_EDU_TIME) FROM CAMPUS.DJ_PROPAG_USER SP
                        LEFT JOIN CAMPUS.DJ_STUDY_INFO SSI ON SP.STUDY_INFO_SN = SSI.STUDY_INFO_SN
                        WHERE SP.STUDY_INFO_SN = CSI.STUDY_INFO_SN AND SSI.ADD_STATUS = 'C' AND PROPAG_EMP_SEQ = #{empSeq} GROUP BY PROPAG_EMP_SEQ
                    ), 0) AS PROPAG_TIME,
                    IFNULL((SELECT SUM(REAL_OJT_TIME) FROM CAMPUS.DJ_OJT_USER SOU
                        LEFT JOIN CAMPUS.DJ_OJT_RESULT SOR ON SOR.OJT_RESULT_SN = SOU.OJT_RESULT_SN
                        LEFT JOIN CAMPUS.DJ_STUDY_INFO SSI ON SOR.STUDY_INFO_SN = SSI.STUDY_INFO_SN
                        WHERE SOU.STUDY_INFO_SN = CSI.STUDY_INFO_SN AND SOR.ACTIVE = 'Y' AND SSI.ADD_STATUS = 'C' AND OJT_EMP_SEQ = #{empSeq} GROUP BY OJT_EMP_SEQ
                    ), 0) AS OJT_TIME,
                    (SELECT STUDY_RESULT_SN FROM CAMPUS.DJ_STUDY_RESULT WHERE STUDY_INFO_SN = CSI.STUDY_INFO_SN) AS STUDY_RESULT_SN,
                    IFNULL((SELECT DSR.STATUS FROM CAMPUS.DJ_STUDY_RESULT DSR
                        LEFT JOIN CAMPUS.DJ_STUDY_INFO SSI ON DSR.STUDY_INFO_SN = SSI.STUDY_INFO_SN
                        WHERE DSR.STUDY_INFO_SN = CSI.STUDY_INFO_SN
                    ), 0) AS STUDY_RES_STATUS
        FROM
                    CAMPUS.DJ_STUDY_INFO CSI,
                    (SELECT @ROWNUM := 0) TMP
                WHERE
                    1=1
                AND
                    ACTIVE = 'Y'
                <if test='applyYear != null and !"".equals(applyYear)'>
                    AND (DATE_FORMAT(START_DT, '%Y') = #{applyYear} OR  DATE_FORMAT(END_DT, '%Y') = #{applyYear})
                </if>
                <if test='studyClass != null and !"".equals(studyClass)'>
                    AND STUDY_CLASS_SN = #{studyClass}
                </if>
            ) RE
            <if test='empSeq !=null and !"".equals(empSeq)'>
            WHERE
                RE.STUDY_INFO_SN IN (
                    SELECT STUDY_INFO_SN
                    FROM CAMPUS.DJ_STUDY_USER
                    WHERE STUDY_EMP_SEQ = #{empSeq}
                )
            </if>
        ORDER BY ROW_NUM DESC
    </select>

    <select id="getStudyInfoOne" resultType="map" parameterType="map">
        /* getStudyInfoOne */
        SELECT
            CSI.*,
            CASE WHEN HDI.DEPT_LEVEL = 2 THEN (SELECT DEPT_NAME FROM CAM_HR.DJ_DEPT_INFO DI WHERE HDI.PARENT_DEPT_SEQ = DI.DEPT_SEQ) ELSE HEI.DEPT_NAME END AS deptNm,
            CASE WHEN HDI.DEPT_LEVEL = 2 THEN HEI.DEPT_NAME ELSE "" END AS teamNm,
            HEI.POSITION_NAME AS positionNm,
            HEI.DUTY_NAME AS dutyNm,
            HEI.JOB_DETAIL AS jobDetailNm,
            DATE_FORMAT(CSI.REG_DATE,'%Y-%m-%d') AS regDate,
            DI.APPRO_KEY,
            DI.DOC_MENU_CD,
            RDI.APPRO_KEY AS RES_APPRO_KEY,
            RDI.DOC_MENU_CD AS RES_DOC_MENU_CD
        FROM
            CAMPUS.DJ_STUDY_INFO CSI
        LEFT JOIN
            CAM_HR.DJ_EMP_INFO HEI ON CSI.REG_EMP_SEQ = HEI.EMP_SEQ
        LEFT JOIN
            CAM_HR.DJ_DEPT_INFO HDI ON HEI.DEPT_SEQ = HDI.DEPT_SEQ
        LEFT JOIN
            DJ_CAMTIC.A_DOC_INFO DI ON CSI.DOC_ID = DI.DOC_ID
        LEFT JOIN
            DJ_CAMTIC.A_DOC_INFO RDI ON CSI.RES_DOC_ID = RDI.DOC_ID
        WHERE STUDY_INFO_SN = #{pk}
    </select>

    <select id="getOjtOjtResultSnOne" resultType="map" parameterType="map">
        /* getOjtOjtResultSnOne */
        SELECT
            OJT_OJT_RESULT_SN
        FROM CAMPUS.dj_ojt_ojt_result
        WHERE STUDY_INFO_SN = #{pk}
    </select>

    <select id="getOjtResultInfoOne" resultType="map" parameterType="map">
        /* getOjtResultInfoOne */
        SELECT
            *
        FROM CAMPUS.dj_ojt_ojt_result
        WHERE STUDY_INFO_SN = #{pk}
    </select>

    <select id="getStudyUserList" resultType="map" parameterType="map">
        /* getStudyUserList */
        SELECT
            CSU.*
        FROM
            CAMPUS.DJ_STUDY_USER CSU
        WHERE STUDY_INFO_SN = #{pk}
        <if test='studyClassSn != null and !"".equals(studyClassSn)'>
            AND STUDY_CLASS_SN = #{studyClassSn}
        </if>
        ORDER BY STUDY_USER_SN
    </select>

    <select id="getStudyJournalList" resultType="map" parameterType="map">
        /* getStudyJournalList */
        SELECT
            @ROWNUM := @ROWNUM + 1 AS ROW_NUM,
            CSJ.*
        FROM
            CAMPUS.DJ_STUDY_JOURNAL CSJ,
            (SELECT @ROWNUM := 0) TMP
        WHERE CSJ.STUDY_INFO_SN = #{studyInfoSn}
        ORDER BY CSJ.JOURNAL_DT DESC
    </select>

    <select id="getStudyJournalOne" resultType="map" parameterType="map">
        /* getStudyJournalOne */
        SELECT
            *
        FROM
            CAMPUS.DJ_STUDY_JOURNAL CSJ
        LEFT JOIN
            CAM_COMMON.DJ_FILE_INFO DFI
        ON
            CSJ.JOURNAL_FILE_SN = DFI.FILE_NO
        WHERE STUDY_JOURNAL_SN = #{studyJournalSn}
    </select>

    <select id="getStudyPropagInfoOne" resultType="map" parameterType="map">
        /* getStudyPropagInfoOne */
        SELECT
            *
        FROM
            CAMPUS.DJ_STUDY_PROPAG CSP
                LEFT JOIN
            CAM_COMMON.DJ_FILE_INFO DFI
            ON
                CSP.PROPAG_FILE_SN = DFI.FILE_NO
        WHERE STUDY_PROPAG_SN = #{studyPropagSn}
    </select>

    <select id="getStudyPropagUserInfo" resultType="map" parameterType="map">
        /* getStudyPropagUserInfo */
        SELECT
            CPU.*
        FROM
            CAMPUS.DJ_PROPAG_USER CPU
        WHERE STUDY_PROPAG_SN = #{studyPropagSn}
          AND PROPAG_CLASS_SN = #{propagClassSn}
        ORDER BY  PROPAG_USER_SN
    </select>

    <select id="getStudyPropagUserInfo2" resultType="map" parameterType="map">
        /* getStudyPropagUserInfo2 */
        SELECT
            MAX(PROPAG_CLASS_TEXT) AS PROPAG_CLASS_TEXT,
            MAX(PROPAG_EMP_NAME) AS PROPAG_EMP_NAME,
            MAX(PROPAG_DEPT_NAME) AS PROPAG_DEPT_NAME,
            MAX(PROPAG_TEAM_NAME) AS PROPAG_TEAM_NAME,
            MAX(PROPAG_POSITION_NAME) AS PROPAG_POSITION_NAME,
            MAX(PROPAG_DUTY_NAME) AS PROPAG_DUTY_NAME,
            IFNULL(SUM(REAL_EDU_TIME), 0) AS REAL_EDU_TIME,
            IFNULL(COUNT(-1), 0) AS EDU_COUNT
        FROM
            CAMPUS.DJ_PROPAG_USER CPU
        WHERE STUDY_INFO_SN = #{studyInfoSn}
        GROUP BY STUDY_INFO_SN, PROPAG_CLASS_SN, PROPAG_EMP_SEQ
        ORDER BY PROPAG_CLASS_SN
    </select>

    <select id="getStudyOjtUserInfo" resultType="map" parameterType="map">
        /* getStudyOjtUserInfo */
        SELECT
            COU.*
        FROM
            CAMPUS.DJ_OJT_USER COU
        WHERE OJT_RESULT_SN = #{ojtResultSn}
          AND OJT_CLASS_SN = #{ojtClassSn}
        ORDER BY  OJT_USER_SN
    </select>

    <select id="getStudyPropagList" resultType="map" parameterType="map">
        /* getStudyPropagList */
        SELECT
            CSJ.*
        FROM
            CAMPUS.DJ_STUDY_PROPAG CSJ
        WHERE CSJ.STUDY_INFO_SN = #{studyInfoSn}
        AND CSJ.ACTIVE = 'Y'
        ORDER BY CSJ.PROPAG_DT DESC
    </select>

    <select id="getStudyPropagUserList" resultType="map" parameterType="map">
        /* getStudyPropagUserList */
        SELECT
            PU.*
        FROM
            CAMPUS.DJ_PROPAG_USER PU
        WHERE PU.STUDY_PROPAG_SN = #{studyPropagSn}
    </select>

    <select id="getOjtPlanList" resultType="map" parameterType="map">
        /* getOjtPlanList */
        SELECT
            *
        FROM
            CAMPUS.DJ_OJT_PLAN COP
        WHERE
            COP.STUDY_INFO_SN = #{pk}
        AND COP.ACTIVE = 'Y'
    </select>

    <select id="getOjtPlanOne" resultType="map" parameterType="map">
        /* getOjtPlanOne */
        SELECT
            *
        FROM
            CAMPUS.DJ_OJT_PLAN COP
        WHERE COP.OJT_PLAN_SN = #{ojtPlanSn}
    </select>

    <select id="getOjtResultList" resultType="map" parameterType="map">
        /* getOjtResultList */
        SELECT
            COR.*,
            (SELECT RES_STATUS FROM CAMPUS.DJ_STUDY_INFO WHERE STUDY_INFO_SN = COR.STUDY_INFO_SN) AS STAT
        FROM
            CAMPUS.DJ_OJT_RESULT COR
        WHERE
            COR.STUDY_INFO_SN = #{pk}
          AND COR.ACTIVE = 'Y'
    </select>

    <select id="getOjtResultOne" resultType="map" parameterType="map">
        /* getOjtResultOne */
        SELECT
            *
        FROM
            CAMPUS.DJ_OJT_RESULT COR
        WHERE COR.OJT_RESULT_SN = #{ojtPlanSn}
    </select>

    <select id="getOpenStudyInfoStatList" resultType="map" parameterType="map">
        /* getOpenStudyInfoStatList */
        SELECT
            @ROWNUM := @ROWNUM + 1 AS ROW_NUM,
            COSI.*,
            IFNULL((SELECT SCOU.REG_EMP_NAME FROM CAMPUS.DJ_OPENSTUDY_USER SCOU WHERE COSI.OPEN_STUDY_INFO_SN = OPEN_STUDY_INFO_SN limit 1), '') AS MEMBER,
            IFNULL((SELECT COUNT(SCOU.REG_EMP_NAME)-1 FROM CAMPUS.DJ_OPENSTUDY_USER SCOU WHERE COSI.OPEN_STUDY_INFO_SN = OPEN_STUDY_INFO_SN), 0) AS MEMBER_COUNT,
            IFNULL(COU.REAL_EDU_TIME, 0) AS REAL_EDU_TIME
        FROM
            CAMPUS.DJ_OPENSTUDY_INFO COSI
        LEFT JOIN
            CAMPUS.DJ_OPENSTUDY_USER COU ON COSI.OPEN_STUDY_INFO_SN = COU.OPEN_STUDY_INFO_SN
        WHERE
            1=1
        AND STEP = 'D'
        AND COU.REG_EMP_SEQ = #{empSeq}
        AND DATE_FORMAT(COSI.OPEN_STUDY_DT, '%Y') = #{eduYear}
        ORDER BY COSI.OPEN_STUDY_INFO_SN DESC
    </select>

    <select id="getOpenStudyInfoList" resultType="map" parameterType="map">
        /* getOpenStudyInfoList */
        SELECT
            RE.*
        FROM
            (
                SELECT
                    @ROWNUM := @ROWNUM + 1 AS ROW_NUM,
                    COSI.*,
                    IFNULL((SELECT SCOU.REG_EMP_NAME FROM CAMPUS.DJ_OPENSTUDY_USER SCOU WHERE COSI.OPEN_STUDY_INFO_SN = OPEN_STUDY_INFO_SN limit 1), '') AS MEMBER,
                    IFNULL((SELECT COUNT(SCOU.REG_EMP_NAME)-1 FROM CAMPUS.DJ_OPENSTUDY_USER SCOU WHERE COSI.OPEN_STUDY_INFO_SN = OPEN_STUDY_INFO_SN), 0) AS MEMBER_COUNT,
                    IFNULL((SELECT COUNT(SCOU.REG_EMP_NAME) FROM CAMPUS.DJ_OPENSTUDY_USER SCOU WHERE COSI.OPEN_STUDY_INFO_SN = OPEN_STUDY_INFO_SN), 0) AS MEMBER_COUNT_TOTAL,
                    IFNULL((SELECT SCOU.REAL_EDU_TIME FROM CAMPUS.DJ_OPENSTUDY_USER SCOU WHERE COSI.OPEN_STUDY_INFO_SN = OPEN_STUDY_INFO_SN AND PART_YN = 'Y' AND REG_EMP_SEQ = #{empSeq}), '-') AS REAL_EDU_TIME
                FROM
                    CAMPUS.DJ_OPENSTUDY_INFO COSI,
                    (SELECT @ROWNUM := 0) TMP
                WHERE 1=1
                    AND ACTIVE = 'Y'
                <if test='step != null and !"".equals(step)'>
                    AND STEP = #{step}
                </if>
                <if test='eduYear!= null and !"".equals(eduYear)'>
                    AND DATE_FORMAT(COSI.open_study_dt, '%Y') = #{eduYear}
                </if>
                <if test='empSeq != null and !"".equals(empSeq)'>
                    AND (COSI.STEP != 'A' OR COSI.REG_EMP_SEQ = #{empSeq})
                </if>

                ORDER BY
                    COSI.REG_DT
            ) RE
        ORDER BY RE.OPEN_STUDY_INFO_SN DESC
    </select>

    <select id="getOpenStudyInfoAdminList" resultType="map" parameterType="map">
        /* getOpenStudyInfoAdminList */
        SELECT
            RE.*
        FROM
            (
                SELECT
                    @ROWNUM := @ROWNUM + 1 AS ROW_NUM,
                    COSI.*,
                    IFNULL((SELECT SCOU.REG_EMP_NAME FROM CAMPUS.DJ_OPENSTUDY_USER SCOU WHERE COSI.OPEN_STUDY_INFO_SN = OPEN_STUDY_INFO_SN limit 1), '') AS MEMBER,
                    IFNULL((SELECT COUNT(SCOU.REG_EMP_NAME)-1 FROM CAMPUS.DJ_OPENSTUDY_USER SCOU WHERE COSI.OPEN_STUDY_INFO_SN = OPEN_STUDY_INFO_SN), 0) AS MEMBER_COUNT,
                    IFNULL((SELECT COUNT(SCOU.REG_EMP_NAME) FROM CAMPUS.DJ_OPENSTUDY_USER SCOU WHERE COSI.OPEN_STUDY_INFO_SN = OPEN_STUDY_INFO_SN), 0) AS MEMBER_COUNT_TOTAL,
                    IFNULL((SELECT SCOU.REAL_EDU_TIME FROM CAMPUS.DJ_OPENSTUDY_USER SCOU WHERE COSI.OPEN_STUDY_INFO_SN = OPEN_STUDY_INFO_SN AND PART_YN = 'Y' AND REG_EMP_SEQ = #{empSeq}), '-') AS REAL_EDU_TIME
                FROM
                    CAMPUS.DJ_OPENSTUDY_INFO COSI,
                    (SELECT @ROWNUM := 0) TMP
                WHERE
                    1=1
                <![CDATA[
                AND DATE_FORMAT(COSI.OPEN_STUDY_DT, '%Y%m') <= DATE_FORMAT(NOW(), '%Y%m')
                AND DATE_FORMAT(NOW(), '%Y%m') <= DATE_FORMAT(COSI.OPEN_STUDY_DT, '%Y%m')
                ]]>
                <if test='empSeq != null and !"".equals(empSeq)'>
                    AND (COSI.STEP != 'A')
                </if>
                <if test='eduYear!= null and !"".equals(eduYear)'>
                    AND DATE_FORMAT(COSI.open_study_dt, '%Y') = #{eduYear}
                </if>
                ORDER BY COSI.REG_DT
            ) RE
        ORDER BY RE.OPEN_STUDY_INFO_SN DESC
    </select>

    <select id="getOpenStudyInfoOne" resultType="map" parameterType="map">
        /* getOpenStudyInfoOne */
        SELECT
            COSI.OPEN_STUDY_INFO_SN,
            IFNULL(COSI.OPEN_STUDY_NAME_RES, COSI.OPEN_STUDY_NAME) AS OPEN_STUDY_NAME,
            IFNULL(COSI.OPEN_STUDY_DT_RES, COSI.OPEN_STUDY_DT) AS OPEN_STUDY_DT,
            IFNULL(COSI.START_TIME_RES, COSI.START_TIME) AS START_TIME,
            IFNULL(COSI.END_TIME_RES, COSI.END_TIME) AS END_TIME,
            IFNULL(COSI.EDU_TIME_RES, COSI.EDU_TIME) AS EDU_TIME,
            COSI.OPEN_STUDY_DETAIL,
            COSI.OPEN_STUDY_LOCATION,
            COSI.REG_EMP_SEQ,
            COSI.REG_EMP_NAME,
            COSI.REG_DT,
            COSI.STEP,
            COSI.OPEN_STUDY_AMT,
            COSI.OPEN_STUDY_AMT_TEXT,
            COSI.STATUS,
            COSI.APPROVAL_EMP_SEQ,
            COSI.APPROVAL_EMP_NAME,
            COSI.APPROVAL_RESULT_DATE,
            COSI.OPEN_STUDY_RESULT,
            COSI.ACTIVE,
            DATE_FORMAT(COSI.REG_DT, '%Y-%m-%d') AS REG_DATE,
            CASE WHEN HDI.DEPT_LEVEL = 2 THEN (SELECT DEPT_NAME FROM CAM_HR.DJ_DEPT_INFO DI WHERE HDI.PARENT_DEPT_SEQ = DI.DEPT_SEQ) ELSE HEI.DEPT_NAME END AS deptNm,
            CASE WHEN HDI.DEPT_LEVEL = 2 THEN HEI.DEPT_NAME ELSE "" END AS teamNm,
            HEI.POSITION_NAME AS positionNm,
            HEI.DUTY_NAME AS dutyNm
        FROM
            CAMPUS.DJ_OPENSTUDY_INFO COSI
        LEFT JOIN
            CAM_HR.DJ_EMP_INFO HEI ON COSI.REG_EMP_SEQ = HEI.EMP_SEQ
        LEFT JOIN
            CAM_HR.DJ_DEPT_INFO HDI ON HEI.DEPT_SEQ = HDI.DEPT_SEQ
        WHERE
            OPEN_STUDY_INFO_SN = #{pk}
    </select>

    <select id="getOpenStudyUserList" resultType="map" parameterType="map">
        /* getOpenStudyUserList */
        SELECT
            COSU.*,
            DATE_FORMAT(COSU.REG_DT, '%Y-%m-%d %H:%i:%s') AS REG_DATE,
            CONCAT((SELECT DEPT_NAME FROM CAM_HR.DJ_DEPT_INFO WHERE DEPT_SEQ = (SELECT PARENT_DEPT_SEQ FROM CAM_HR.DJ_DEPT_INFO WHERE DEPT_SEQ = B.DEPT_SEQ)), ' ', (SELECT DEPT_NAME FROM CAM_HR.DJ_DEPT_INFO WHERE DEPT_SEQ = B.DEPT_SEQ)) AS DEPT_FULL_NAME
        FROM
            CAMPUS.DJ_OPENSTUDY_USER COSU
        LEFT JOIN CAM_HR.DJ_EMP_INFO B ON COSU.REG_EMP_SEQ = B.EMP_SEQ
        WHERE
            OPEN_STUDY_INFO_SN = #{pk}
        AND PART_YN = 'Y'
        <if test='userClass != null and !"".equals(userClass)'>
            AND USER_CLASS = #{userClass}
        </if>
    </select>

    <select id="getOpenStudyUserList2" resultType="map" parameterType="map">
        /* getOpenStudyUserList2 */
        SELECT
        COSU.*,
        DATE_FORMAT(COSU.REG_DT, '%Y-%m-%d %H:%i:%s') AS REG_DATE,
        (SELECT IF(DEPT_SEQ = 1000, '', DEPT_NAME) FROM CAM_HR.DJ_DEPT_INFO WHERE DEPT_SEQ = (SELECT PARENT_DEPT_SEQ FROM CAM_HR.DJ_DEPT_INFO WHERE DEPT_SEQ = B.DEPT_SEQ)) as DEPT_NAME,
        (SELECT DEPT_NAME FROM CAM_HR.DJ_DEPT_INFO WHERE DEPT_SEQ = B.DEPT_SEQ) as TEAM_NAME,
        CONCAT((SELECT DEPT_NAME FROM CAM_HR.DJ_DEPT_INFO WHERE DEPT_SEQ = (SELECT PARENT_DEPT_SEQ FROM CAM_HR.DJ_DEPT_INFO WHERE DEPT_SEQ = B.DEPT_SEQ)), ' ', (SELECT DEPT_NAME FROM CAM_HR.DJ_DEPT_INFO WHERE DEPT_SEQ = B.DEPT_SEQ)) AS DEPT_FULL_NAME
        FROM
        CAMPUS.DJ_OPENSTUDY_USER COSU
        LEFT JOIN CAM_HR.DJ_EMP_INFO B ON COSU.REG_EMP_SEQ = B.EMP_SEQ
        WHERE
        OPEN_STUDY_INFO_SN = #{pk}
        <if test='userClass != null and !"".equals(userClass)'>
            AND USER_CLASS = #{userClass}
        </if>
    </select>

    <select id="getOpenStudyResultList" resultType="map" parameterType="map">
        /* getOpenStudyResultList */
        SELECT
            *
        FROM
            CAMPUS.DJ_OPENSTUDY_INFO
        WHERE
            OPEN_STUDY_INFO_SN = #{pk}
    </select>

    <select id="getCommonEduStatList" resultType="map" parameterType="map">
        /* getCommonEduStatList */
        SELECT
            CCE.*,
            (SELECT COUNT(*) FROM CAMPUS.DJ_COMMON_EDU_USER SCCEU WHERE SCCEU.COMMON_EDU_SN = CCE.COMMON_EDU_SN AND PART_YN = 'Y' AND ACTIVE = 'Y') AS PART_COUNT,
            (SELECT COUNT(*) FROM CAMPUS.DJ_COMMON_EDU_USER SCCEU WHERE SCCEU.COMMON_EDU_SN = CCE.COMMON_EDU_SN AND PART_YN = 'N' AND ACTIVE = 'Y') AS NO_PART_COUNT
        FROM
            CAMPUS.DJ_COMMON_EDU CCE
        LEFT JOIN CAMPUS.DJ_COMMON_EDU_USER CCEU ON CCE.COMMON_EDU_SN = CCEU.COMMON_EDU_SN
        WHERE
            1=1
        AND CCEU.REG_EMP_SEQ = #{empSeq}
        AND DATE_FORMAT(CCE.START_DT, '%Y') = #{eduYear}
        AND CCEU.ACTIVE = 'Y'
        ORDER BY CCE.COMMON_EDU_SN DESC
    </select>

    <select id="getCommonEduList" resultType="map" parameterType="map">
        /* getCommonEduList */
        SELECT
            CE.*,
            (SELECT COUNT(*) FROM CAMPUS.DJ_COMMON_EDU_USER SCEU WHERE SCEU.COMMON_EDU_SN = CE.COMMON_EDU_SN AND PART_YN = 'Y' AND ACTIVE = 'Y') AS PART_COUNT,
            (SELECT COUNT(*) FROM CAMPUS.DJ_COMMON_EDU_USER SCEU WHERE SCEU.COMMON_EDU_SN = CE.COMMON_EDU_SN AND PART_YN = 'N' AND ACTIVE = 'Y') AS NO_PART_COUNT
        FROM
            CAMPUS.DJ_COMMON_EDU CE
        LEFT JOIN CAMPUS.DJ_COMMON_EDU_USER CEU ON CE.COMMON_EDU_SN = CEU.COMMON_EDU_SN
        WHERE
            1=1
    <![CDATA[
        AND
            (DATE_FORMAT(CE.START_DT, '%Y') = #{eduYear} OR DATE_FORMAT(CE.END_DT, '%Y') = #{eduYear})
    ]]>
        <if test='empSeq != null and !"".equals(empSeq)'>
            AND CEU.REG_EMP_SEQ = #{empSeq}
        </if>
        AND CEU.ACTIVE = 'Y'
        GROUP BY CE.COMMON_EDU_SN
        ORDER BY CE.COMMON_EDU_SN DESC
    </select>

    <select id="getCommonEduMngList" resultType="map" parameterType="map">
        /* getCommonEduMngList */
        SELECT
            CE.*,
        (SELECT COUNT(*) FROM CAMPUS.DJ_COMMON_EDU_USER SCEU WHERE SCEU.COMMON_EDU_SN = CE.COMMON_EDU_SN AND PART_YN = 'Y' AND ACTIVE = 'Y') AS PART_COUNT,
        (SELECT COUNT(*) FROM CAMPUS.DJ_COMMON_EDU_USER SCEU WHERE SCEU.COMMON_EDU_SN = CE.COMMON_EDU_SN AND PART_YN = 'N' AND ACTIVE = 'Y') AS NO_PART_COUNT
        FROM
            CAMPUS.DJ_COMMON_EDU CE
        WHERE
            1=1
        <![CDATA[
        AND
            (DATE_FORMAT(CE.START_DT, '%Y') = #{eduYear} OR DATE_FORMAT(CE.END_DT, '%Y') = #{eduYear})
        ]]>
        ORDER BY CE.COMMON_EDU_SN DESC
    </select>

    <select id="getCommonEduOne" resultType="map" parameterType="map">
        /* getCommonEduOne */
        SELECT
            CCE.*
        FROM
            CAMPUS.DJ_COMMON_EDU CCE
        WHERE
            COMMON_EDU_SN = #{pk}
    </select>

    <select id="getCommonEduUserList" resultType="map" parameterType="map">
        /* getCommonEduUserList */
        SELECT
            CCEU.*
        FROM
            CAMPUS.DJ_COMMON_EDU_USER CCEU
        WHERE
            COMMON_EDU_SN = #{pk}
        AND ACTIVE = 'Y'
    </select>

    <select id="getCommonEduUserAddList" resultType="map" parameterType="map">
        /* getCommonEduUserAddList */
        SELECT
            HEI.EMP_SEQ AS REG_EMP_SEQ,
            HEI.EMP_NAME_KR AS REG_EMP_NAME,
            CASE WHEN HDI.DEPT_LEVEL = 2 THEN (SELECT DEPT_NAME FROM CAM_HR.DJ_DEPT_INFO DI WHERE HDI.PARENT_DEPT_SEQ = DI.DEPT_SEQ) ELSE HEI.DEPT_NAME END AS REG_DEPT_NAME,
            CASE WHEN HDI.DEPT_LEVEL = 2 THEN HEI.DEPT_NAME ELSE "" END AS REG_TEAM_NAME,
            HEI.POSITION_NAME AS REG_POSITION_NAME,
            HEI.DUTY_NAME AS REG_DUTY_NAME
        FROM
            CAM_HR.DJ_EMP_INFO HEI
        LEFT JOIN
            CAM_HR.DJ_DEPT_INFO HDI ON HEI.DEPT_SEQ = HDI.DEPT_SEQ
        WHERE
            (DIVISION = 0 OR (DIVISION = 4 AND DIVISION_SUB != 3))
        AND WORK_STATUS_CODE = 'Y'
        AND EMP_SEQ NOT IN (SELECT REG_EMP_SEQ AS EMP_SEQ FROM CAMPUS.DJ_COMMON_EDU_USER SCCEU WHERE COMMON_EDU_SN = #{pk} AND ACTIVE = 'Y')
        ORDER BY EMP_NAME_KR
    </select>

    <select id="getEduStat" resultType="map" parameterType="map">
        /* getEduStat */
        SELECT
            CASE WHEN HDI.DEPT_LEVEL = 2 THEN CONCAT((SELECT DEPT_NAME FROM CAM_HR.DJ_DEPT_INFO DI WHERE HDI.PARENT_DEPT_SEQ = DI.DEPT_SEQ), " ",(SELECT DEPT_NAME FROM CAM_HR.DJ_DEPT_INFO DI WHERE HDI.DEPT_SEQ = DI.DEPT_SEQ)) ELSE HEI.DEPT_NAME END AS TEAM,
            HEI.DUTY_NAME,
            HEI.EMP_NAME_KR AS EMP_NAME,
            (CASE WHEN CEI.DUTY_CLASS = '1' THEN '주업무' ELSE '보조업무' END) AS DUTY_CLASS,
            CEC.LARGE_CATEGORY_NAME,
            CEC.EDU_CATEGORY_NAME,
            CONCAT('Level ', CECD.LEVEL_ID) AS LEVEL,
            CECD.EDU_CATEGORY_DETAIL_NAME,
            (SELECT SUM(SER.REAL_EDU_TIME) FROM CAMPUS.DJ_EDU_INFO SEI LEFT JOIN CAMPUS.DJ_EDU_RESULT SER ON SEI.EDU_INFO_ID = SER.EDU_INFO_ID WHERE SEI.REG_EMP_SEQ = CEI.REG_EMP_SEQ AND SEI.EDU_CATEGORY_DETAIL_NAME = CECD.EDU_CATEGORY_DETAIL_NAME AND CEI.DUTY_CLASS = SEI.DUTY_CLASS AND SEI.ACTIVE = 'Y' AND SER.STATUS = 100 AND SER.MNG_CHECK = 'Y' AND DATE_FORMAT(SER.APPROVAL_SEND_DATE, '%Y') = #{eduYear}) AS SUM_TIME,
            (SELECT COUNT(SER.REAL_EDU_TIME) FROM CAMPUS.DJ_EDU_INFO SEI LEFT JOIN CAMPUS.DJ_EDU_RESULT SER ON CEI.EDU_INFO_ID = SER.EDU_INFO_ID WHERE SEI.REG_EMP_SEQ = CEI.REG_EMP_SEQ AND SEI.EDU_CATEGORY_DETAIL_NAME = CECD.EDU_CATEGORY_DETAIL_NAME AND CEI.DUTY_CLASS = SEI.DUTY_CLASS AND SEI.ACTIVE = 'Y' AND SER.STATUS = 100 AND SER.MNG_CHECK = 'Y' AND DATE_FORMAT(SER.APPROVAL_SEND_DATE, '%Y') = #{eduYear}) AS COUNT_BY,
            (SELECT SUM(SER.REAL_EDU_TIME) FROM CAMPUS.DJ_EDU_INFO SEI LEFT JOIN CAMPUS.DJ_EDU_RESULT SER ON SEI.EDU_INFO_ID = SER.EDU_INFO_ID WHERE SEI.REG_EMP_SEQ = CEI.REG_EMP_SEQ AND SEI.ACTIVE = 'Y' AND SER.STATUS = 100 AND SER.MNG_CHECK = 'Y' AND DATE_FORMAT(SER.APPROVAL_SEND_DATE, '%Y') = #{eduYear}) AS SUM_ALL
        FROM
            CAMPUS.DJ_EDU_INFO CEI
        LEFT JOIN
            CAM_HR.DJ_EMP_INFO HEI ON CEI.REG_EMP_SEQ = HEI.EMP_SEQ
        LEFT JOIN
            CAM_HR.DJ_DEPT_INFO HDI ON HEI.DEPT_SEQ = HDI.DEPT_SEQ
        LEFT JOIN
            CAMPUS.DJ_EDU_CATEGORY_DETAIL CECD ON CEI.EDU_CATEGORY_DETAIL_ID = CECD.EDU_CATEGORY_DETAIL_ID
        LEFT JOIN
            CAMPUS.DJ_EDU_CATEGORY CEC ON CEC.EDU_CATEGORY_ID = CECD.EDU_CATEGORY_ID
        LEFT JOIN
            CAMPUS.DJ_EDU_RESULT CER ON CEI.EDU_INFO_ID = CER.EDU_INFO_ID
        WHERE
            1=1
        <if test='empName != null and !"".equals(empName)'>
            AND HEI.EMP_NAME_KR LIKE CONCAT('%', #{empName}, '%')
        </if>
        AND CER.STATUS = 100
        AND CER.MNG_CHECK = 'Y'
        AND CEI.ACTIVE = 'Y' AND CER.STATUS = 100 AND CER.MNG_CHECK = 'Y' AND DATE_FORMAT(CER.APPROVAL_SEND_DATE, '%Y') = #{eduYear}
        GROUP BY HEI.EMP_NAME_KR, DUTY_CLASS, EDU_CATEGORY_DETAIL_NAME
    </select>

    <select id="getEduAllStatList" resultType="map" parameterType="map">
        /* getEduAllStatList */
        <![CDATA[
        SELECT
            CASE WHEN HDI.DEPT_LEVEL = 2 THEN CONCAT((SELECT DEPT_NAME FROM CAM_HR.DJ_DEPT_INFO DI WHERE HDI.PARENT_DEPT_SEQ = DI.DEPT_SEQ), " ",(SELECT DEPT_NAME FROM CAM_HR.DJ_DEPT_INFO DI WHERE HDI.DEPT_SEQ = DI.DEPT_SEQ)) ELSE HEI.DEPT_NAME END AS DEPT,
            CASE WHEN HEI.DUTY_NAME = "" THEN HEI.POSITION_NAME ELSE HEI.DUTY_NAME END AS POSITION,
            HEI.POSITION_NAME,
            HEI.DUTY_NAME ,
            HEI.EMP_NAME_KR AS EMP_NAME,
            IFNULL((
                SELECT SUM(REAL_EDU_TIME)
                FROM CAMPUS.DJ_EDU_RESULT SER
                WHERE SER.REG_EMP_SEQ = HEI.EMP_SEQ AND SER.ACTIVE = 'Y' AND SER.STATUS = 100 AND DATE_FORMAT(#{startDt}, '%Y%m%d') <= DATE_FORMAT(SER.APPROVAL_SEND_DATE, '%Y%m%d') AND DATE_FORMAT(#{endDt}, '%Y%m%d') >= DATE_FORMAT(SER.APPROVAL_SEND_DATE, '%Y%m%d')
            ), 0) AS PERSONAL_TIME,
            (
                SELECT COUNT(-1)
                FROM CAMPUS.DJ_EDU_RESULT SER
                WHERE SER.REG_EMP_SEQ = HEI.EMP_SEQ AND SER.ACTIVE = 'Y' AND SER.STATUS = 100 AND DATE_FORMAT(#{startDt}, '%Y%m%d') <= DATE_FORMAT(SER.APPROVAL_SEND_DATE, '%Y%m%d') AND DATE_FORMAT(#{endDt}, '%Y%m%d') >= DATE_FORMAT(SER.APPROVAL_SEND_DATE, '%Y%m%d')
            ) AS PERSONAL_COUNT,
            IFNULL((
                SELECT SUM(STUDY_TIME) FROM CAMPUS.DJ_STUDY_JOURNAL SJ
                LEFT JOIN CAMPUS.DJ_STUDY_RESULT_USER SRU ON SJ.STUDY_JOURNAL_SN = SRU.STUDY_JOURNAL_SN
                LEFT JOIN CAMPUS.DJ_STUDY_INFO SSI ON SJ.STUDY_INFO_SN = SSI.STUDY_INFO_SN
                WHERE SRU.STUDY_EMP_SEQ = HEI.EMP_SEQ AND SJ.ACTIVE = 'Y' AND DATE_FORMAT(#{startDt}, '%Y%m%d') <= DATE_FORMAT(SJ.JOURNAL_DT, '%Y%m%d') AND DATE_FORMAT(#{endDt}, '%Y%m%d') >= DATE_FORMAT(SJ.JOURNAL_DT, '%Y%m%d') AND SSI.ADD_STATUS = 'S'
            ), 0) AS STUDY_TIME,
            (
                SELECT COUNT(-1) FROM CAMPUS.DJ_STUDY_JOURNAL SJ
                LEFT JOIN CAMPUS.DJ_STUDY_RESULT_USER SRU ON SJ.STUDY_JOURNAL_SN = SRU.STUDY_JOURNAL_SN
                LEFT JOIN CAMPUS.DJ_STUDY_INFO SSI ON SJ.STUDY_INFO_SN = SSI.STUDY_INFO_SN
                WHERE SRU.STUDY_EMP_SEQ = HEI.EMP_SEQ AND SJ.ACTIVE = 'Y' AND DATE_FORMAT(#{startDt}, '%Y%m%d') <= DATE_FORMAT(SJ.JOURNAL_DT, '%Y%m%d') AND DATE_FORMAT(#{endDt}, '%Y%m%d') >= DATE_FORMAT(SJ.JOURNAL_DT, '%Y%m%d') AND SSI.ADD_STATUS = 'S'
            ) AS STUDY_COUNT,
            IFNULL((
                SELECT SUM(REAL_EDU_TIME) FROM CAMPUS.DJ_STUDY_PROPAG SP
                LEFT JOIN CAMPUS.DJ_PROPAG_USER SPU ON SP.STUDY_PROPAG_SN = SPU.STUDY_PROPAG_SN
                LEFT JOIN CAMPUS.DJ_STUDY_INFO SSI ON SP.STUDY_INFO_SN = SSI.STUDY_INFO_SN
                WHERE SPU.PROPAG_EMP_SEQ = HEI.EMP_SEQ AND SP.ACTIVE = 'Y' AND DATE_FORMAT(#{startDt}, '%Y%m%d') <= DATE_FORMAT(SP.PROPAG_DT, '%Y%m%d') AND DATE_FORMAT(#{endDt}, '%Y%m%d') >= DATE_FORMAT(SP.PROPAG_DT, '%Y%m%d') AND SSI.ADD_STATUS = 'S'
            ), 0) AS PROPAG_TIME,
            (
                SELECT COUNT(-1) FROM CAMPUS.DJ_STUDY_PROPAG SP
                LEFT JOIN CAMPUS.DJ_PROPAG_USER SPU ON SP.STUDY_PROPAG_SN = SPU.STUDY_PROPAG_SN
                LEFT JOIN CAMPUS.DJ_STUDY_INFO SSI ON SP.STUDY_INFO_SN = SSI.STUDY_INFO_SN
                WHERE SPU.PROPAG_EMP_SEQ = HEI.EMP_SEQ AND SP.ACTIVE = 'Y' AND DATE_FORMAT(#{startDt}, '%Y%m%d') <= DATE_FORMAT(SP.PROPAG_DT, '%Y%m%d') AND DATE_FORMAT(#{endDt}, '%Y%m%d') >= DATE_FORMAT(SP.PROPAG_DT, '%Y%m%d') AND SSI.ADD_STATUS = 'S'
            ) AS PROPAG_COUNT,
            IFNULL((
                SELECT SUM(CASE WHEN OJT_CLASS_SN = 4 THEN SOR.EDU_TIME ELSE SOR.EDU_TIME_HALF END) FROM CAMPUS.DJ_OJT_USER SOU
                LEFT JOIN CAMPUS.DJ_OJT_RESULT SOR ON SOR.OJT_RESULT_SN = SOU.OJT_RESULT_SN
                LEFT JOIN CAMPUS.DJ_STUDY_INFO SSI ON SOR.STUDY_INFO_SN = SSI.STUDY_INFO_SN
                WHERE SOU.OJT_EMP_SEQ = HEI.EMP_SEQ AND SOR.ACTIVE = 'Y' AND DATE_FORMAT(#{startDt}, '%Y%m%d') <= DATE_FORMAT(SOR.OJT_DT, '%Y%m%d') AND DATE_FORMAT(#{endDt}, '%Y%m%d') >= DATE_FORMAT(SOR.OJT_DT, '%Y%m%d') AND SSI.ADD_STATUS = 'S'
            ), 0) AS OJT_TIME,
            (
                SELECT COUNT(-1) FROM CAMPUS.DJ_OJT_USER SOU
                LEFT JOIN CAMPUS.DJ_OJT_RESULT SOR ON SOR.OJT_RESULT_SN = SOU.OJT_RESULT_SN
                LEFT JOIN CAMPUS.DJ_STUDY_INFO SSI ON SOR.STUDY_INFO_SN = SSI.STUDY_INFO_SN
                WHERE SOU.OJT_EMP_SEQ = HEI.EMP_SEQ AND SOR.ACTIVE = 'Y' AND DATE_FORMAT(#{startDt}, '%Y%m%d') <= DATE_FORMAT(SOR.OJT_DT, '%Y%m%d') AND DATE_FORMAT(#{endDt}, '%Y%m%d') >= DATE_FORMAT(SOR.OJT_DT, '%Y%m%d') AND SSI.ADD_STATUS = 'S'
            ) AS OJT_COUNT,
            IFNULL((
                SELECT SUM(EDU_TIME) FROM CAMPUS.DJ_OPENSTUDY_INFO COI
                LEFT JOIN CAMPUS.DJ_OPENSTUDY_USER COU ON COI.OPEN_STUDY_INFO_SN = COU.OPEN_STUDY_INFO_SN
                WHERE COU.REG_EMP_SEQ = HEI.EMP_SEQ AND COI.STATUS = 100 AND COU.PART_YN = 'Y' AND DATE_FORMAT(#{startDt}, '%Y%m%d') <= DATE_FORMAT(COI.OPEN_STUDY_DT, '%Y%m%d') AND DATE_FORMAT(#{endDt}, '%Y%m%d') >= DATE_FORMAT(COI.OPEN_STUDY_DT, '%Y%m%d')
            ), 0) AS OPEN_STUDY_TIME,
            (
                SELECT COUNT(EDU_TIME) FROM
                CAMPUS.DJ_OPENSTUDY_INFO COI LEFT JOIN CAMPUS.DJ_OPENSTUDY_USER COU ON COI.OPEN_STUDY_INFO_SN = COU.OPEN_STUDY_INFO_SN
                WHERE COU.REG_EMP_SEQ = HEI.EMP_SEQ AND COI.STATUS = 100 AND COU.PART_YN = 'Y' AND DATE_FORMAT(#{startDt}, '%Y%m%d') <= DATE_FORMAT(COI.OPEN_STUDY_DT, '%Y%m%d') AND DATE_FORMAT(#{endDt}, '%Y%m%d') >= DATE_FORMAT(COI.OPEN_STUDY_DT, '%Y%m%d')
            ) AS OPEN_STUDY_COUNT,
            IFNULL((
                SELECT SUM(CCEU.REAR_EDU_TIME)
                FROM CAMPUS.DJ_COMMON_EDU CCE LEFT JOIN CAMPUS.DJ_COMMON_EDU_USER CCEU ON CCE.COMMON_EDU_SN = CCEU.COMMON_EDU_SN
                WHERE CCEU.REG_EMP_SEQ = HEI.EMP_SEQ AND CCE.STATUS = 100 AND CCEU.PART_YN = 'Y' AND CCEU.ACTIVE = 'Y' AND DATE_FORMAT(#{startDt}, '%Y%m%d') <= DATE_FORMAT(CCE.START_DT, '%Y%m%d') AND DATE_FORMAT(#{endDt}, '%Y%m%d') >= DATE_FORMAT(CCE.START_DT, '%Y%m%d')
            ), 0) AS COMMON_EDU_TIME,
            (
                SELECT COUNT(CCEU.REAR_EDU_TIME) FROM CAMPUS.DJ_COMMON_EDU CCE
                LEFT JOIN CAMPUS.DJ_COMMON_EDU_USER CCEU ON CCE.COMMON_EDU_SN = CCEU.COMMON_EDU_SN
                WHERE CCEU.REG_EMP_SEQ = HEI.EMP_SEQ AND CCE.STATUS = 100 AND CCEU.PART_YN = 'Y' AND CCEU.ACTIVE = 'Y' AND DATE_FORMAT(#{startDt}, '%Y%m%d') <= DATE_FORMAT(CCE.START_DT, '%Y%m%d') AND DATE_FORMAT(#{endDt}, '%Y%m%d') >= DATE_FORMAT(CCE.START_DT, '%Y%m%d')
            ) AS COMMON_EDU_COUNT
        FROM
            CAM_HR.DJ_EMP_INFO HEI
        LEFT JOIN
            CAM_HR.DJ_DEPT_INFO HDI ON HEI.DEPT_SEQ = HDI.DEPT_SEQ
        WHERE
            1=1
        ]]>
        <if test='"Y".equals(active)'>
            AND (DIVISION = 0 OR (DIVISION = 4 AND DIVISION_SUB != 3))
            AND WORK_STATUS_CODE = 'Y'
        </if>
        <if test='dept != null and !"".equals(dept)'>
            AND (HEI.DEPT_SEQ = #{dept} OR HDI.PARENT_DEPT_SEQ = #{dept})
        </if>
        <if test='team != null and !"".equals(team)'>
            AND HEI.DEPT_SEQ = #{team}
        </if>
        <if test='empSeq != null and !"".equals(empSeq)'>
            AND HEI.EMP_SEQ = #{empSeq}
        </if>
        <if test='sEmpName != null and !"".equals(sEmpName)'>
            AND HEI.EMP_NAME_KR LIKE CONCAT('%', #{sEmpName}, '%')
        </if>
        ORDER BY EMP_NAME_KR
    </select>

    <select id="getEduMyStatList" resultType="map" parameterType="map">
        /* getEduMyStatList */
        SELECT
        CASE WHEN HDI.DEPT_LEVEL = 2 THEN CONCAT((SELECT DEPT_NAME FROM CAM_HR.DJ_DEPT_INFO DI WHERE HDI.PARENT_DEPT_SEQ = DI.DEPT_SEQ), " ",HEI.DEPT_NAME) ELSE HEI.DEPT_NAME END AS DEPT,
        CASE WHEN HEI.DUTY_NAME = "" THEN HEI.POSITION_NAME ELSE HEI.DUTY_NAME END AS POSITION,
        HEI.EMP_NAME_KR AS EMP_NAME,
        IFNULL((
            SELECT SUM(REAL_EDU_TIME)
            FROM CAMPUS.DJ_EDU_RESULT SER
            WHERE SER.REG_EMP_SEQ = HEI.EMP_SEQ AND SER.ACTIVE = 'Y' AND SER.STATUS = 100 AND DATE_FORMAT((SELECT START_DT FROM CAMPUS.DJ_EDU_INFO WHERE EDU_INFO_ID = SER.EDU_INFO_ID), '%Y') = #{eduYear}
        ), 0) AS PERSONAL_TIME,
        (
            SELECT COUNT(-1)
            FROM CAMPUS.DJ_EDU_RESULT SER
            WHERE SER.REG_EMP_SEQ = HEI.EMP_SEQ AND SER.ACTIVE = 'Y' AND SER.STATUS = 100 AND DATE_FORMAT((SELECT START_DT FROM CAMPUS.DJ_EDU_INFO WHERE EDU_INFO_ID = SER.EDU_INFO_ID), '%Y') = #{eduYear}
        ) AS PERSONAL_COUNT,
        IFNULL((
            SELECT SUM(STUDY_TIME) FROM CAMPUS.DJ_STUDY_JOURNAL SJ
            LEFT JOIN CAMPUS.DJ_STUDY_RESULT_USER SRU ON SJ.STUDY_JOURNAL_SN = SRU.STUDY_JOURNAL_SN
            LEFT JOIN CAMPUS.DJ_STUDY_INFO SSI ON SJ.STUDY_INFO_SN = SSI.STUDY_INFO_SN
            WHERE SRU.STUDY_EMP_SEQ = HEI.EMP_SEQ AND SJ.ACTIVE = 'Y' AND DATE_FORMAT(SJ.JOURNAL_DT, '%Y') = #{eduYear} AND SSI.ADD_STATUS = 'S'
        ), 0) AS STUDY_TIME,
        (
            SELECT COUNT(-1) FROM CAMPUS.DJ_STUDY_JOURNAL SJ
            LEFT JOIN CAMPUS.DJ_STUDY_RESULT_USER SRU ON SJ.STUDY_JOURNAL_SN = SRU.STUDY_JOURNAL_SN
            LEFT JOIN CAMPUS.DJ_STUDY_INFO SSI ON SJ.STUDY_INFO_SN = SSI.STUDY_INFO_SN
            WHERE SRU.STUDY_EMP_SEQ = HEI.EMP_SEQ AND SJ.ACTIVE = 'Y' AND DATE_FORMAT(SJ.JOURNAL_DT, '%Y') = #{eduYear} AND SSI.ADD_STATUS = 'S'
        ) AS STUDY_COUNT,
        IFNULL((
            SELECT SUM(REAL_EDU_TIME) FROM CAMPUS.DJ_STUDY_PROPAG SP
            LEFT JOIN CAMPUS.DJ_PROPAG_USER SPU ON SP.STUDY_PROPAG_SN = SPU.STUDY_PROPAG_SN
            LEFT JOIN CAMPUS.DJ_STUDY_INFO SSI ON SP.STUDY_INFO_SN = SSI.STUDY_INFO_SN
            WHERE SPU.PROPAG_EMP_SEQ = HEI.EMP_SEQ AND SP.ACTIVE = 'Y' AND DATE_FORMAT(SP.PROPAG_DT, '%Y') = #{eduYear} AND SSI.ADD_STATUS != 'N'
        ), 0) AS PROPAG_TIME,
        (
            SELECT COUNT(-1) FROM CAMPUS.DJ_STUDY_PROPAG SP
            LEFT JOIN CAMPUS.DJ_PROPAG_USER SPU ON SP.STUDY_PROPAG_SN = SPU.STUDY_PROPAG_SN
            LEFT JOIN CAMPUS.DJ_STUDY_INFO SSI ON SP.STUDY_INFO_SN = SSI.STUDY_INFO_SN
            WHERE SPU.PROPAG_EMP_SEQ = HEI.EMP_SEQ AND SP.ACTIVE = 'Y' AND DATE_FORMAT(SP.PROPAG_DT, '%Y') = #{eduYear} AND SSI.ADD_STATUS = 'S'
        ) AS PROPAG_COUNT,
        IFNULL((
            SELECT
                SUM(IFNULL((SELECT SUM(REAL_OJT_TIME) FROM CAMPUS.DJ_OJT_USER WHERE STUDY_INFO_SN = CSI.STUDY_INFO_SN AND OJT_EMP_SEQ = CSU.STUDY_EMP_SEQ), 0))
            FROM
                CAMPUS.DJ_STUDY_INFO CSI
            LEFT JOIN
                CAMPUS.DJ_STUDY_USER CSU ON CSI.STUDY_INFO_SN = CSU.STUDY_INFO_SN
            WHERE
                CSU.STUDY_EMP_SEQ = HEI.EMP_SEQ
            AND CSI.STUDY_CLASS_SN IN(3)
            AND DATE_FORMAT(START_DT, '%Y') = #{eduYear}
        ), 0) AS OJT_TIME,
        (
            SELECT COUNT(-1) FROM CAMPUS.DJ_OJT_USER SOU
            LEFT JOIN CAMPUS.DJ_OJT_RESULT SOR ON SOR.OJT_RESULT_SN = SOU.OJT_RESULT_SN
            LEFT JOIN CAMPUS.DJ_STUDY_INFO SSI ON SOR.STUDY_INFO_SN = SSI.STUDY_INFO_SN
            WHERE SOU.OJT_EMP_SEQ = HEI.EMP_SEQ AND SOR.ACTIVE = 'Y' AND DATE_FORMAT(SOR.OJT_DT, '%Y') = #{eduYear} AND SSI.ADD_STATUS = 'S'
        ) AS OJT_COUNT,
        IFNULL((SELECT SUM(COU.REAL_EDU_TIME) FROM CAMPUS.DJ_OPENSTUDY_INFO COI LEFT JOIN CAMPUS.DJ_OPENSTUDY_USER COU ON COI.OPEN_STUDY_INFO_SN = COU.OPEN_STUDY_INFO_SN WHERE COU.REG_EMP_SEQ = HEI.EMP_SEQ AND COI.STATUS = 100 AND COU.PART_YN = 'Y' AND DATE_FORMAT(COI.OPEN_STUDY_DT, '%Y') = #{eduYear}), 0) AS OPEN_STUDY_TIME,
        (SELECT COUNT(EDU_TIME) FROM CAMPUS.DJ_OPENSTUDY_INFO COI LEFT JOIN CAMPUS.DJ_OPENSTUDY_USER COU ON COI.OPEN_STUDY_INFO_SN = COU.OPEN_STUDY_INFO_SN WHERE COU.REG_EMP_SEQ = HEI.EMP_SEQ AND COI.STATUS = 100 AND COU.PART_YN = 'Y' AND DATE_FORMAT(COI.OPEN_STUDY_DT, '%Y') = #{eduYear}) AS OPEN_STUDY_COUNT,
        IFNULL((SELECT SUM(CCEU.REAR_EDU_TIME) FROM CAMPUS.DJ_COMMON_EDU CCE LEFT JOIN CAMPUS.DJ_COMMON_EDU_USER CCEU ON CCE.COMMON_EDU_SN = CCEU.COMMON_EDU_SN WHERE CCEU.REG_EMP_SEQ = HEI.EMP_SEQ AND CCE.STATUS = 100 AND CCEU.PART_YN = 'Y' AND CCEU.ACTIVE = 'Y' AND DATE_FORMAT(CCE.START_DT, '%Y') = #{eduYear}), 0) AS COMMON_EDU_TIME,
        (SELECT COUNT(CCEU.REAR_EDU_TIME) FROM CAMPUS.DJ_COMMON_EDU CCE LEFT JOIN CAMPUS.DJ_COMMON_EDU_USER CCEU ON CCE.COMMON_EDU_SN = CCEU.COMMON_EDU_SN WHERE CCEU.REG_EMP_SEQ = HEI.EMP_SEQ AND CCE.STATUS = 100 AND CCEU.PART_YN = 'Y' AND CCEU.ACTIVE = 'Y' AND DATE_FORMAT(CCE.START_DT, '%Y') = #{eduYear}) AS COMMON_EDU_COUNT
        FROM
        CAM_HR.DJ_EMP_INFO HEI
        LEFT JOIN
        CAM_HR.DJ_DEPT_INFO HDI ON HEI.DEPT_SEQ = HDI.DEPT_SEQ
        WHERE
        (DIVISION = 0 OR (DIVISION = 4 AND DIVISION_SUB != 3))
        <if test='empSeq != null and !"".equals(empSeq)'>
            AND HEI.EMP_SEQ = #{empSeq}
        </if>
        <if test='sEmpName != null and !"".equals(sEmpName)'>
            AND HEI.EMP_NAME_KR LIKE CONCAT('%', #{sEmpName}, '%')
        </if>
        AND WORK_STATUS_CODE = 'Y'
        ORDER BY EMP_NAME_KR
    </select>

    <select id="getDutyInfoList" resultType="map" parameterType="map">
        /* getDutyInfoList */
        SELECT
            CDI.*,
            DATE_FORMAT(CONCAT(CDI.DUTY_MONTH, '-01'), '%Y년 %m월') AS DUTY_MONTH_TEXT
        FROM
            CAMPUS.DJ_DUTY_INFO CDI
        WHERE
            1=1
        <if test='regEmpSeq != null and !"".equals(regEmpSeq)'>
            AND CDI.REG_EMP_SEQ = #{regEmpSeq}
        </if>
        ORDER BY CDI.DUTY_MONTH DESC, CDI.DUTY_INFO_SN DESC
    </select>

    <select id="getDutyInfoOne" resultType="map" parameterType="map">
        /* getDutyInfoOne */
        SELECT
            CDI.*,
            CASE WHEN HEI.DUTY_NAME = "" THEN HEI.POSITION_NAME ELSE HEI.DUTY_NAME END AS SPOT,
            HEI.DEPT_SEQ AS REG_DEPT_SEQ,
            IF(HEI.DEPT_NAME = '', HEI.DEPT_TEAM_NAME, HEI.DEPT_NAME) AS REG_DEPT_NAME,
            HEI.DUTY_CODE AS REG_DUTY_CODE
        FROM
            CAMPUS.DJ_DUTY_INFO CDI
        LEFT JOIN
            CAM_HR.DJ_EMP_INFO HEI ON CDI.REG_EMP_SEQ = HEI.EMP_SEQ
        WHERE
            DUTY_INFO_SN = #{pk}
    </select>

    <select id="getDutyInfoMngList" resultType="map" parameterType="map">
        /* getDutyInfoMngList */
        SELECT
            RE.*,
            CONCAT(RE.DEPT_NAME, " ", RE.TEAM_NAME) AS DEPT
        FROM (
            SELECT
                HEI.EMP_SEQ AS EMP_SEQ,
                HEI.DEPT_SEQ,
                (SELECT COUNT(*) FROM CAM_HR.DJ_EMP_INFO WHERE DEPT_SEQ = HDI.DEPT_SEQ AND (DUTY_CODE = 4 OR DUTY_CODE = 5)) AS DUTY_CNT,
                (CASE WHEN HDI.DEPT_LEVEL = 2 THEN (SELECT DEPT_NAME FROM CAM_HR.DJ_DEPT_INFO DI WHERE HDI.PARENT_DEPT_SEQ = DI.DEPT_SEQ) ELSE (SELECT DEPT_NAME FROM CAM_HR.DJ_DEPT_INFO DI WHERE HDI.DEPT_SEQ = DI.DEPT_SEQ) END) AS DEPT_NAME,
                (CASE WHEN HDI.DEPT_LEVEL = 2 THEN (SELECT DEPT_NAME FROM CAM_HR.DJ_DEPT_INFO DI WHERE HDI.DEPT_SEQ = DI.DEPT_SEQ) ELSE "" END) AS TEAM_NAME,
                CASE WHEN HDI.DEPT_LEVEL = 2 THEN CONCAT((SELECT DEPT_NAME FROM CAM_HR.DJ_DEPT_INFO DI WHERE HDI.PARENT_DEPT_SEQ = DI.DEPT_SEQ), " ",(SELECT DEPT_NAME FROM CAM_HR.DJ_DEPT_INFO DI WHERE HDI.DEPT_SEQ = DI.DEPT_SEQ)) ELSE HEI.DEPT_NAME END AS DEPT,
                CASE WHEN HEI.DUTY_NAME = "" THEN HEI.POSITION_NAME ELSE HEI.DUTY_NAME END AS POSITION,
                IFNULL(HEI.DUTY_CODE, '') AS DUTY_CODE,
                HEI.DUTY_NAME,
                HEI.POSITION_CODE,
                HEI.POSITION_NAME,
                HEI.EMP_NAME_KR AS EMP_NAME,
                HEI.OFFICE_TEL_NUM,
                IFNULL((SELECT SCET.EDU_TARGET_ID FROM campus.dj_edu_target SCET WHERE SCET.TARGET_YEAR = #{requestYear} AND SCET.REG_EMP_SEQ = HEI.EMP_SEQ), 'N') AS TARGET_CHECK,
                IFNULL((SELECT SCET.STATUS FROM campus.dj_edu_target SCET WHERE SCET.TARGET_YEAR = #{requestYear} AND SCET.REG_EMP_SEQ = HEI.EMP_SEQ), 'N') AS TARGET_STATUS,
                IFNULL((SELECT SCET.LD_STAT FROM campus.dj_edu_target SCET WHERE SCET.TARGET_YEAR = #{requestYear} AND SCET.REG_EMP_SEQ = HEI.EMP_SEQ), 'N') AS LD_STATUS,
                IFNULL((SELECT SCET.MNG_STAT FROM campus.dj_edu_target SCET WHERE SCET.TARGET_YEAR = #{requestYear} AND SCET.REG_EMP_SEQ = HEI.EMP_SEQ), 'N') AS MNG_STATUS,
                IFNULL((SELECT DATE_FORMAT(SCET.APPROVAL_RESULT_DATE, '%Y-%m-%d') FROM campus.dj_edu_target SCET WHERE SCET.TARGET_YEAR = #{requestYear} AND SCET.REG_EMP_SEQ = HEI.EMP_SEQ), '-') AS TARGET_APPROVAL_DATE,
                IFNULL((SELECT SCDI.DUTY_INFO_SN FROM CAMPUS.DJ_DUTY_INFO SCDI WHERE SCDI.DUTY_YEAR = #{requestYear} AND SCDI.REG_EMP_SEQ = HEI.EMP_SEQ ORDER BY SCDI.DUTY_MONTH DESC LIMIT 1), 'N') AS DUTY_CHECK,
                IFNULL((SELECT SCDI.STATUS FROM CAMPUS.DJ_DUTY_INFO SCDI WHERE SCDI.DUTY_YEAR = #{requestYear} AND SCDI.REG_EMP_SEQ = HEI.EMP_SEQ ORDER BY SCDI.DUTY_MONTH DESC LIMIT 1), 'N') AS DUTY_STATUS,
                IFNULL((SELECT SCDI.LD_STAT FROM CAMPUS.DJ_DUTY_INFO SCDI WHERE SCDI.DUTY_YEAR = #{requestYear} AND SCDI.REG_EMP_SEQ = HEI.EMP_SEQ ORDER BY SCDI.DUTY_MONTH DESC LIMIT 1), 'N') AS DUTY_LD_STATUS,
                IFNULL((SELECT SCDI.MNG_STAT FROM CAMPUS.DJ_DUTY_INFO SCDI WHERE SCDI.DUTY_YEAR = #{requestYear} AND SCDI.REG_EMP_SEQ = HEI.EMP_SEQ ORDER BY SCDI.DUTY_MONTH DESC LIMIT 1), 'N') AS DUTY_MNG_STATUS,
                IFNULL((SELECT DATE_FORMAT(APPROVAL_RESULT_DATE, '%Y-%m-%d') FROM CAMPUS.DJ_DUTY_INFO SCDI WHERE SCDI.DUTY_YEAR = #{requestYear} AND SCDI.REG_EMP_SEQ = HEI.EMP_SEQ ORDER BY SCDI.DUTY_MONTH DESC LIMIT 1), '-') AS DUTY_APPROVAL_DATE
            FROM
                CAM_HR.DJ_EMP_INFO HEI
            LEFT JOIN
                CAM_HR.DJ_DEPT_INFO HDI ON HEI.DEPT_SEQ = HDI.DEPT_SEQ
            WHERE
                1=1
            AND HEI.TEMP_DIVISION = 'N'
        <if test='dept != null and !"".equals(dept)'>
            AND (HEI.DEPT_SEQ = #{dept} OR HDI.PARENT_DEPT_SEQ = #{dept})
        </if>
        <if test='team != null and !"".equals(team)'>
            AND HEI.DEPT_SEQ = #{team}
        </if>
        <if test='searchValue != null and !"".equals(searchValue)'>
            AND HEI.EMP_NAME_KR LIKE CONCAT('%', #{searchValue}, '%')
        </if>
        <if test='"Y".equals(active)'>
            AND (DIVISION = 0 OR (DIVISION = 4 AND DIVISION_SUB != 3))
            AND WORK_STATUS_CODE = 'Y'
        </if>
        ) RE
        WHERE 1=1
    <if test='"Y".equals(status)'>
        AND RE.TARGET_STATUS = '100'
    </if>
    <if test='"N".equals(status)'>
        AND RE.TARGET_STATUS = '10'
    </if>
    <if test='"Y".equals(status2)'>
        AND RE.DUTY_STATUS = '100'
    </if>
    <if test='"N".equals(status2)'>
        AND RE.TARGET_STATUS = '10'
    </if>
        ORDER BY (
            CASE WHEN DEPT_NAME = '캠틱종합기술원' THEN 1 WHEN ASCII(SUBSTRING(DEPT_NAME,1)) <![CDATA[<]]> 123 THEN 3 ELSE 2 END
        ), DEPT_NAME, TEAM_NAME, DUTY_NAME DESC, POSITION_CODE, EMP_NAME;
    </select>

    <select id="getEduInfoFile" parameterType="map" resultType="map">
        /*getEduInfoFile*/
        SELECT
            *
        FROM
            CAM_COMMON.DJ_FILE_INFO
        WHERE
            FILE_CD = 'eduReq'
        AND CONTENT_ID = CONCAT('eduInfo_', #{EDU_INFO_ID})
    </select>

    <select id="getEduResultInfoFile" parameterType="map" resultType="map">
        /*getEduResultInfoFile*/
        SELECT
            *
        FROM
            CAM_COMMON.DJ_FILE_INFO
        WHERE
            FILE_CD = 'eduRes'
          AND CONTENT_ID = CONCAT('eduInfo_', #{EDU_INFO_ID})
    </select>

    <insert id="setEduInfoInsert" parameterType="map">
        /* setEduInfoInsert */
        INSERT INTO CAMPUS.DJ_EDU_INFO
            (
                REG_EMP_SEQ,
                REG_EMP_NAME,
                DEPT_NAME,
                DEPT_SEQ,
                EDU_CATEGORY_DETAIL_ID,
                EDU_CATEGORY_DETAIL_NAME,
                LEVEL_ID,
                DUTY_CLASS,
                EDU_NAME,
                EDU_OBJECT,
                EDU_CONTENT,
                START_DT,
                END_DT,
                TERM_DAY,
                TERM_TIME,
                CARE_NAME,
                CARE_LOCATION,
                CARE_TEL_NUM,
                <if test='eduMoney != null and eduMoney != ""'>
                    EDU_MONEY,
                </if>
                EDU_MONEY_TYPE,
                <if test='returnMoney != null and returnMoney != ""'>
                    RETURN_MONEY,
                </if>
                RETURN_DOC,
                ATTACH_DOC_NAME,
                REG_DT,
                <if test='eduFormType == "3"'>
                    OBJECT_FORUM_TYPE,
                    <if test='objectForumType == "1"'>
                        OBJECT_FORUM_VAL,
                    </if>
                </if>
                <if test='eduFormType == "5"'>
                    BOOK_WRITER_NAME,
                    BOOK_PAGE_VAL,
                    BOOK_PULISH_NAME,
                </if>
                <if test='eduFormType == "6"'>
                    TREA_ORIGIN,
                    TREA_UNIT,
                </if>
                <if test='eduFormType == "7"'>
                    TREA_TYPE,
                    TREA_USER,
                </if>
                <if test='eduFormType == "8"'>
                    BOOK_UNIT,
                </if>
                <if test='eduFormType == "10"'>
                    COMP_TYPE,
                </if>
                PURC_TYPE,
                <if test="pjtSn != null and !''.equals(pjtSn)">
                    PJT_SN,
                </if>
                EDU_FORM_TYPE
            )
        VALUES
            (
                #{empSeq},
                #{empName},
                #{deptName},
                #{deptSeq},
                #{eduCategoryDetailId},
                #{eduCategoryDetailName},
                #{levelId},
                #{dutyClass},
                #{eduName},
                #{eduObject},
                #{eduContent},
                #{startDt},
                #{endDt},
                ifnull(#{termDay}, 0),
                ifnull(#{termTime}, 0),
                #{careName},
                #{careLocation},
                #{careTelNum},
                <if test='eduMoney != null and eduMoney != ""'>
                    #{eduMoney},
                </if>
                #{eduMoneyType},
                <if test='returnMoney != null and returnMoney != ""'>
                    #{returnMoney},
                </if>
                #{returnDoc},
                #{attachDocName},
                #{regDate},
                <if test='eduFormType == "3"'>
                    #{objectForumText},
                    <if test='objectForumType == "1"'>
                        #{objectForumVal},
                    </if>
                </if>
                <if test='eduFormType == "5"'>
                    #{bookWriter},
                    #{bookPage},
                    #{bookPulish},
                </if>
                <if test='eduFormType == "6"'>
                    #{treaOrigin},
                    #{treaUnit},
                </if>
                <if test='eduFormType == "7"'>
                    #{treaType},
                    #{treaUser},
                </if>
                <if test='eduFormType == "8"'>
                    #{bookUnit},
                </if>
                <if test='eduFormType == "10"'>
                    #{compType},
                </if>
                #{purcType},
                <if test="pjtSn != null and !''.equals(pjtSn)">
                    #{pjtSn},
                </if>
                #{eduFormType}
            )
        <selectKey keyProperty="eduInfoId" resultType="Integer" order="BEFORE">
            SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'CAMPUS' AND TABLE_NAME = 'DJ_EDU_INFO'
        </selectKey>
    </insert>

    <update id="setEduInfoModify" parameterType="map">
        UPDATE
            CAMPUS.DJ_EDU_INFO
        SET
            EDU_CATEGORY_DETAIL_ID =#{eduCategoryDetailId},
            EDU_CATEGORY_DETAIL_NAME =#{eduCategoryDetailName},
            LEVEL_ID=#{levelId},
            DUTY_CLASS=#{dutyClass},
            EDU_NAME=#{eduName},
            EDU_OBJECT=#{eduObject},
            EDU_CONTENT=#{eduContent},
            START_DT=#{startDt},
            END_DT=#{endDt},
            TERM_DAY=ifnull(#{termDay}, 0),
            TERM_TIME=ifnull(#{termTime}, 0),
            CARE_NAME=#{careName},
            CARE_LOCATION=#{careLocation},
            CARE_TEL_NUM=#{careTelNum},
            <if test='eduMoney != null and eduMoney != ""'>
                EDU_MONEY=#{eduMoney},
            </if>
            EDU_MONEY_TYPE=#{eduMoneyType},
            <if test='returnMoney != null and returnMoney != ""'>
                RETURN_MONEY=#{returnMoney},
            </if>
            RETURN_DOC=#{returnDoc},
            ATTACH_DOC_NAME=#{attachDocName},
            <if test='eduFormType == "3"'>
                OBJECT_FORUM_TYPE=#{objectForumText},
                <if test='objectForumType == "1"'>
                    OBJECT_FORUM_VAL=#{objectForumVal},
                </if>
            </if>
            <if test='eduFormType == "5"'>
                BOOK_WRITER_NAME=#{bookWriter},
                BOOK_PAGE_VAL=#{bookPage},
                BOOK_PULISH_NAME=#{bookPulish},
            </if>
            <if test='eduFormType == "6"'>
                TREA_ORIGIN=#{treaOrigin},
                TREA_UNIT=#{treaUnit},
            </if>
            <if test='eduFormType == "7"'>
                TREA_TYPE=#{treaType},
                TREA_USER=#{treaUser},
            </if>
            <if test='eduFormType == "8"'>
                BOOK_UNIT=#{bookUnit},
            </if>
            <if test='eduFormType == "10"'>
                COMP_TYPE=#{compType},
            </if>
            PURC_TYPE = #{purcType},
            <if test="pjtSn != null and !''.equals(pjtSn)">
                PJT_SN = #{pjtSn},
            </if>
            REG_DT=#{regDate}
        WHERE
            EDU_INFO_ID = #{eduInfoId}

    </update>

    <update id="setEduInfoUpdate" parameterType="map">
        /* setEduInfoUpdate */
        UPDATE
            CAMPUS.DJ_EDU_INFO
        SET
            <if test='eduFormType == "1"'>
                TERM_DAY = #{termDay},
                TERM_TIME = #{termTime},
            </if>
            EDU_CONTENT = #{eduContent}
        WHERE
            EDU_INFO_ID = #{eduInfoId}
    </update>

    <insert id="setEduResultInsert" parameterType="map">
        /* setEduResultInsert */
        INSERT INTO CAMPUS.DJ_EDU_RESULT
            (
                EDU_INFO_ID,
                EDU_NAME,
                EDU_OBJECT,
                EDU_CONTENT,
                START_DT,
                END_DT,
                TERM_DAY,
                TERM_TIME,
                CARE_NAME,
                CARE_LOCATION,
                OBJECT_FORUM_TYPE,
                OBJECT_FORUM_VAL,
                BOOK_PAGE_VAL,
                BOOK_PULISH_NAME,
                TREA_ORIGIN,
                TREA_UNIT,
                TREA_TYPE,
                TREA_USER,
                BOOK_UNIT,
                COMP_TYPE,
                EDU_TEACHER_NAME,
                EDU_EVAL,
                EDU_POINT,
                FBLIST,
                ATTACH_DOC_NAME,
                REG_EMP_SEQ
            )
        VALUES
            (
                #{eduInfoId},
                #{eduName},
                #{eduObject},
                #{eduContent},
                #{startDt},
                #{endDt},
                #{termDay},
                #{termTime},
                #{careName},
                #{careLocation},
                #{objectForumText},
                #{objectForumVal},
                #{bookPageVal},
                #{bookPulishName},
                #{treaOrigin},
                #{treaUnit},
                #{treaType},
                #{treaUser},
                #{bookUnit},
                #{compType},
                #{eduTeacherName},
                #{eduEval},
                #{eduPoint},
                #{FBList},
                #{attachDocName},
                #{empSeq}
            )
    </insert>

    <update id="setEduResultModify" parameterType="map">
        UPDATE
            CAMPUS.DJ_EDU_RESULT
        SET
            EDU_NAME = #{eduName},
            EDU_OBJECT = #{eduObject},
            EDU_CONTENT = #{eduContent},
            START_DT = #{startDt},
            END_DT = #{endDt},
            TERM_DAY = #{termDay},
            TERM_TIME = #{termTime},
            CARE_NAME = #{careName},
            CARE_LOCATION = #{careLocation},
            OBJECT_FORUM_TYPE = #{objectForumText},
            OBJECT_FORUM_VAL = #{objectForumVal},
            BOOK_PAGE_VAL = #{bookPageVal},
            BOOK_PULISH_NAME = #{bookPulishName},
            TREA_ORIGIN = #{treaOrigin},
            TREA_UNIT = #{treaUnit},
            TREA_TYPE = #{treaType},
            TREA_USER = #{treaUser},
            BOOK_UNIT = #{bookUnit},
            COMP_TYPE = #{compType},
            EDU_EVAL = #{eduEval},
            EDU_POINT = #{eduPoint},
            FBLIST = #{FBList}
        WHERE
            EDU_INFO_ID = #{eduInfoId}
    </update>

    <update id="setMngCheckUpd" parameterType="map">
        /* setMngCheckUpd */
        UPDATE
            CAMPUS.DJ_EDU_RESULT
        SET
            MNG_CHECK = #{mngCheck},
            REAL_EDU_TIME = #{realEduTime}
        WHERE
            EDU_INFO_ID = (SELECT SER.EDU_INFO_ID FROM CAMPUS.DJ_EDU_INFO SEI LEFT JOIN CAMPUS.DJ_EDU_RESULT SER ON SEI.EDU_INFO_ID = SER.EDU_INFO_ID WHERE SER.STATUS = 100 AND SER.EDU_INFO_ID = #{pk})
    </update>

    <update id="setEduResultEduTimeUpd" parameterType="map">
        /* setEduResultEduTimeUpd */
        UPDATE
            CAMPUS.DJ_EDU_RESULT
        SET
            MNG_CHECK = 'Y',
            REAL_EDU_TIME = #{realEduTime}
        WHERE
            EDU_INFO_ID = #{eduInfoId}
    </update>

    <insert id="setStudyInfoInsert" parameterType="map">
        /* setStudyInfoInsert */
        INSERT INTO CAMPUS.DJ_STUDY_INFO
            (
                STUDY_CLASS_SN,
                STUDY_CLASS_TEXT,
                STUDY_NAME,
                START_DT,
                END_DT,
                DATE_VAL,
                STUDY_LOCATION,
                STUDY_OBJECT,
                STUDY_CONTENT,
                STUDY_MONEY,
                STUDY_MONEY_VAL,
                ATTACH,
                <if test='startTime != null and startTime != ""'>
                    START_TIME,
                </if>
                <if test='endTime != null and endTime != ""'>
                    END_TIME,
                </if>
                <if test='eduTerm != null and eduTerm != ""'>
                    EDU_TERM,
                </if>
                <if test='eduTime != null and eduTime != ""'>
                    EDU_TIME,
                </if>
                REG_EMP_SEQ,
                REG_EMP_NAME,
                REG_DT
            )
        VALUES
            (
                #{studyClassSn},
                #{studyClassText},
                #{studyName},
                #{startDt},
                #{endDt},
                #{dateVal},
                #{studyLocation},
                #{studyObject},
                #{studyContent},
                #{studyMoney},
                #{studyMoneyVal},
                #{attach},
                <if test='startTime != null and startTime != ""'>
                    #{startTime},
                </if>
                <if test='endTime != null and endTime != ""'>
                    #{endTime},
                </if>
                <if test='eduTerm != null and eduTerm != ""'>
                    #{eduTerm},
                </if>
                <if test='eduTime != null and eduTime != ""'>
                    #{eduTime},
                </if>
                #{empSeq},
                #{empName},
                #{regDate}
            )
        <selectKey keyProperty="studyUserSn" resultType="Integer" order="BEFORE">
            SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'CAMPUS' AND TABLE_NAME = 'DJ_STUDY_INFO'
        </selectKey>
    </insert>

    <update id="setStudyInfoModify"  parameterType="map">
       /* setStudyInfoModify */
       UPDATE
           CAMPUS.DJ_STUDY_INFO
       SET
           STUDY_NAME = #{studyName},
           START_DT = #{startDt},
           END_DT = #{endDt},
           START_TIME = #{startTime},
           END_TIME = #{endTime},
           EDU_TERM = #{eduTerm},
           EDU_TIME = #{eduTime},
           STUDY_LOCATION = #{studyLocation},
           STUDY_OBJECT = #{studyObject},
           STUDY_CONTENT = #{studyContent},
           STUDY_MONEY = #{studyMoney},
           STUDY_MONEY_VAL = #{studyMoneyVal}
       WHERE
            STUDY_INFO_SN = #{pk}

    </update>


    <insert id="setStudyUserInsert" parameterType="map">
        /* setStudyUserInsert */
        INSERT INTO CAMPUS.DJ_STUDY_USER
            (
                STUDY_INFO_SN,
                <if test='studyClassSn != null and studyClassSn != ""'>
                    STUDY_CLASS_SN,
                </if>
                <if test='studyClassText != null and studyClassText != ""'>
                    STUDY_CLASS_TEXT,
                </if>
                STUDY_EMP_SEQ,
                STUDY_EMP_NAME,
                STUDY_DEPT_NAME,
                STUDY_TEAM_NAME,
                STUDY_POSITION_NAME,
                STUDY_DUTY_NAME
            )
        VALUES
            (
                <choose>
                    <when test='studyUserSn != null and studyUserSn != ""'>
                        #{studyUserSn},
                    </when>
                    <otherwise>
                        #{pk},
                    </otherwise>
                </choose>
                <if test='studyClassSn != null and studyClassSn != ""'>
                    #{studyClassSn},
                </if>
                <if test='studyClassText != null and studyClassText != ""'>
                    #{studyClassText},
                </if>
                #{empSeq},
                #{studyEmpName},
                #{studyDeptName},
                #{studyTeamName},
                #{studyPositionName},
                #{studyDutyName}
            )
    </insert>

    <update id="setStudyUserMngReset" parameterType="map">
        /* setStudyUserMngReset */
        UPDATE
            CAMPUS.DJ_STUDY_USER
        SET
            STUDY_CLASS_SN = '3',
            STUDY_CLASS_TEXT = '조원'
        WHERE
            STUDY_INFO_SN = #{studyInfoSn}
        AND STUDY_CLASS_SN = #{studyClassSn}
    </update>

    <update id="setStudyUserMngUpdate" parameterType="map">
        /* setStudyUserMngUpdate */
        UPDATE
            CAMPUS.DJ_STUDY_USER
        SET
            STUDY_CLASS_SN = #{studyClassSn},
            STUDY_CLASS_TEXT = #{studyClassText}
        WHERE
            STUDY_USER_SN = #{studyUserSn}
    </update>

    <update id="studyReq" parameterType="map">
        /* studyReq */
        UPDATE
            CAMPUS.DJ_STUDY_INFO
        SET
            STATUS = #{status}
        WHERE
            STUDY_INFO_SN = #{studyInfoSn}
    </update>

    <insert id="setStudyJournalInsert" parameterType="map">
        /* setStudyJournalInsert */
        INSERT INTO CAMPUS.DJ_STUDY_JOURNAL
            (
                STUDY_INFO_SN,
                STUDY_NAME,
                STUDY_EMP_SEQ,
                STUDY_EMP_NAME,
                JOURNAL_DT,
                JOURNAL_START_TIME,
                JOURNAL_END_TIME,
                JOURNAL_TIME,
                JOURNAL_LOCATE,
                JOURNAL_CONTENT,
                JOURNAL_AMT,
                JOURNAL_AMT_CLASS,
                JOURNAL_AMT_CLASS_TEXT,
                JOURNAL_AMT_ETC,
                REG_EMP_NAME,
                REG_EMP_SEQ
            )
        VALUES
            (
                #{studyInfoSn},
                #{studyName},
                #{studyEmpSeq},
                #{studyEmpName},
                #{journalDt},
                #{journalStartTime},
                #{journalEndTime},
                #{realEduTime},
                #{studyLocation},
                #{studyContent},
                #{studyMoney},
                #{journalAmtClass},
                #{journalAmtClassText},
                #{journalAmtEtc},
                #{regEmpName},
                #{regEmpSeq}
            )
        <selectKey keyProperty="studyJournalSn" resultType="Integer" order="BEFORE">
            SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'CAMPUS' AND TABLE_NAME = 'DJ_STUDY_JOURNAL'
        </selectKey>
    </insert>

    <update id="setStudyJournalModify" parameterType="map">
        UPDATE
            CAMPUS.DJ_STUDY_JOURNAL
        SET
            STUDY_NAME =  #{studyName},
            STUDY_EMP_SEQ =  #{studyEmpSeq},
            STUDY_EMP_NAME = #{studyEmpName},
            JOURNAL_DT = #{journalDt},
            JOURNAL_START_TIME = #{journalStartTime},
            JOURNAL_END_TIME = #{journalEndTime},
            JOURNAL_TIME = #{realEduTime},
            JOURNAL_LOCATE = #{studyLocation},
            JOURNAL_CONTENT = #{studyContent},
            JOURNAL_AMT = #{studyMoney},
            JOURNAL_AMT_CLASS = #{journalAmtClass},
            JOURNAL_AMT_CLASS_TEXT = #{journalAmtClassText},
            JOURNAL_AMT_ETC = #{journalAmtEtc}
        WHERE
            STUDY_JOURNAL_SN = #{studyJournalSn}
    </update>

    <delete id="setOjtUserDelete" parameterType="map">
        /* setOjtUserDelete */
        DELETE FROM
            CAMPUS.DJ_OJT_USER
        WHERE
            OJT_RESULT_SN = #{ojtResultSn}
    </delete>

    <delete id="setStudyResultUserDelete" parameterType="map">
        /* setStudyResultUserDelete */
        DELETE FROM
            CAMPUS.DJ_STUDY_RESULT_USER
        WHERE
            STUDY_JOURNAL_SN = #{studyJournalSn}
    </delete>

    <update id="setStudyResultModify" parameterType="map">
        UPDATE
            CAMPUS.DJ_STUDY_RESULT
        SET
            STUDY_RESULT_DT = #{studyResultDt},
            STUDY_RESULT_START_TIME = #{studyResultStartTime},
            STUDY_RESULT_END_TIME = #{studyResultEndTime},
            STUDY_RESULT_LOCATE = #{studyResultLocate},
            STUDY_RESULT_CONTENT = #{studyResultContent},
            STUDY_RESULT_AMT = #{studyResultAmt},
            STUDY_EMP_SEQ = #{studyEmpSeq},
            STUDY_EMP_NAME = #{studyEmpName},
            STUDY_RESULT_TIME = #{studyResultTime}
        WHERE
            STUDY_RESULT_SN = #{studyResultSn}

    </update>

    <insert id="setStudyResult" parameterType="map">
        /*setStudyResult*/
        INSERT INTO CAMPUS.DJ_STUDY_RESULT
            (
                STUDY_INFO_SN,
                STUDY_NAME,
                STUDY_EMP_SEQ,
                STUDY_EMP_NAME,
                STUDY_RESULT_DT,
                STUDY_RESULT_START_TIME,
                STUDY_RESULT_END_TIME,
                STUDY_RESULT_TIME,
                STUDY_RESULT_LOCATE,
                STUDY_RESULT_CONTENT,
                STUDY_RESULT_AMT,
                REG_EMP_NAME,
                ACTIVE
            )
        VALUES
            (
                #{studyInfoSn},
                #{studyName},
                #{studyEmpSeq},
                #{studyEmpName},
                #{studyResultDt},
                #{studyResultStartTime},
                #{studyResultEndTime},
                #{studyResultTime},
                #{studyResultLocate},
                #{studyResultContent},
                #{studyResultAmt},
                #{regEmpName},
                'N'
            )
        <selectKey keyProperty="studyResultSn" resultType="Integer" order="BEFORE">
            SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'CAMPUS' AND TABLE_NAME = 'DJ_STUDY_RESULT'
        </selectKey>
    </insert>

    <insert id="setOjtOjtResultInsert" parameterType="map">
        /*setOjtOjtResultInsert*/
        INSERT INTO CAMPUS.DJ_OJT_OJT_RESULT
        (
        STUDY_INFO_SN,
        START_DT,
        END_DT,
        STUDY_LOCATION,
        STUDY_OBJECT,
        STUDY_CONTENT,
        STUDY_MONEY,
        STUDY_MONEY_VAL,
        REG_DT
        )
        VALUES
        (
        #{studyInfoSn},
        #{START_DT},
        #{END_DT},
        #{ojtLocationTd},
        #{ojtObjectTd},
        #{ojtContentTd},
        #{ojtAmtTd},
        #{ojtAmtTextTd},
        #{regDateTd}
        )
        <selectKey keyProperty="ojtOjtResultSn" resultType="Integer" order="BEFORE">
            SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'CAMPUS' AND TABLE_NAME = 'DJ_OJT_OJT_RESULT'
        </selectKey>
    </insert>

    <update id="setOjtOjtResultModify" parameterType="map">
        UPDATE
            CAMPUS.DJ_OJT_OJT_RESULT
        SET
            START_DT = #{START_DT},
            END_DT = #{END_DT},
            STUDY_LOCATION = #{ojtLocationTd},
            STUDY_OBJECT = #{ojtObjectTd},
            STUDY_CONTENT = #{ojtContentTd},
            STUDY_MONEY = #{ojtAmtTd},
            STUDY_MONEY_VAL = #{ojtAmtTextTd},
            REG_DT = #{regDateTd}
        WHERE
            OJT_OJT_RESULT_SN = #{ojtResultSn}
    </update>

    <update id="setStudyResultY" parameterType="map">
        UPDATE
            CAMPUS.DJ_STUDY_RESULT
        SET
            ACTIVE = 'Y'
        WHERE
            STUDY_INFO_SN = #{studyInfoSn}
    </update>

    <delete id="deleteStudyJournal" parameterType="map">
        /* deleteStudyJournal */
        DELETE FROM CAMPUS.DJ_STUDY_JOURNAL
        WHERE
            STUDY_JOURNAL_SN = #{studyJournalSn}
    </delete>

    <update id="setStudyJournalUpdate" parameterType="map">
        /*setStudyJournalUpdate*/
        UPDATE CAMPUS.DJ_STUDY_JOURNAL
        SET
            JOURNAL_FILE_SN = #{file_no}
        WHERE
            STUDY_JOURNAL_SN = #{studyJournalSn}
    </update>

    <update id="setStudyPropagUpdate" parameterType="map">
        /*setStudyPropagUpdate*/
        UPDATE CAMPUS.DJ_STUDY_PROPAG
        SET
            PROPAG_FILE_SN = #{file_no}
        WHERE
            STUDY_PROPAG_SN = #{studyPropagSn}
    </update>

    <update id="setStudyJournalApp" parameterType="map">
        /* setStudyJournalApp */
        UPDATE
            CAMPUS.DJ_STUDY_JOURNAL
        SET
            <if test='studyClassSn == 1'>
                CAPTAIN_APPOVAL_YN = #{status}
            </if>
            <if test='studyClassSn == 2'>
                ASSISTANT_APPOVAL_YN = #{status}
            </if>
        WHERE
            STUDY_JOURNAL_SN = #{studyJournalSn}
    </update>

    <insert id="setOjtPlanInsert" parameterType="map">
        /* setOjtPlanInsert */
        INSERT INTO CAMPUS.DJ_OJT_PLAN
            (
                STUDY_INFO_SN,
                START_DT,
                END_DT,
                TITLE,
                ETC,
                REG_EMP_SEQ,
                REG_EMP_NAME
            )
        VALUES
            (
                #{studyInfoSn},
                #{startDt},
                #{endDt},
                #{title},
                #{etc},
                #{regEmpSeq},
                #{regEmpName}
            )
    </insert>

    <select id="getStudyResultData" parameterType="map" resultType="map">
        /*getStudyResultData*/
        SELECT
            A.*,
            DI.APPRO_KEY,
            DI.DOC_MENU_CD
        FROM
            CAMPUS.DJ_STUDY_RESULT A
        LEFT JOIN
            DJ_CAMTIC.A_DOC_INFO DI ON A.DOC_ID = DI.DOC_ID
        WHERE
            STUDY_RESULT_SN = #{studyResultSn}
    </select>

    <update id="setOjtPlanUpdate" parameterType="map">
        /* setOjtPlanUpdate */
        UPDATE
            CAMPUS.DJ_OJT_PLAN
        SET
            TITLE = #{title},
            ETC = #{etc}
        WHERE
            OJT_PLAN_SN = #{ojtPlanSn}
    </update>

    <update id="setOjtPlanDelete" parameterType="map">
        /* setOjtPlanDelete */
        UPDATE
            CAMPUS.DJ_OJT_PLAN
        SET
            ACTIVE = 'N'
        WHERE
            OJT_PLAN_SN = #{ojtPlanSn}
    </update>

    <insert id="setOjtResultInsert" parameterType="map">
        /* setOjtResultInsert */
        INSERT INTO CAMPUS.DJ_OJT_RESULT
            (
                STUDY_INFO_SN,
                OJT_DT,
                STUDY_CONT_A,
                STUDY_CONT_B,
                START_TIME,
                END_TIME,
                EDU_FULL_TIME,
                EDU_TIME,
                EDU_TIME_HALF,
                LOCATION,
                CONTENT,
                ETC,
                SAVE_TYPE,
                SAVE_TYPE_TEXT,
                REG_EMP_SEQ,
                REG_EMP_NAME
            )
        VALUES
            (
                #{studyInfoSn},
                #{ojtDt},
                #{studyContA},
                #{studyContB},
                #{startTime},
                #{endTime},
                ROUND(TIME_TO_SEC((SELECT TIMEDIFF(#{endTime}, #{startTime}))) / 3600, 1),
                IF(ROUND(TIME_TO_SEC((SELECT TIMEDIFF(#{endTime}, #{startTime}))) / 3600 , 1) > 2, 2,ROUND(TIME_TO_SEC((SELECT TIMEDIFF(#{endTime}, #{startTime}))) / 3600, 1)),
                IF((ROUND(TIME_TO_SEC((SELECT TIMEDIFF(#{endTime}, #{startTime}))) / 3600, 1) / 2 > 2), 2, (ROUND(TIME_TO_SEC((SELECT TIMEDIFF(#{endTime}, #{startTime}))) / 3600, 1) / 2)),
                #{location},
                #{content},
                #{etc},
                #{saveType},
                #{saveTypeText},
                #{regEmpSeq},
                #{regEmpName}
            )
        <selectKey keyProperty="ojtResultSn" resultType="Integer" order="BEFORE">
            SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'CAMPUS' AND TABLE_NAME = 'DJ_OJT_RESULT'
        </selectKey>
    </insert>

    <update id="setOjtResultModify" parameterType="map">
        /* setOjtResultModify */
        UPDATE
            CAMPUS.DJ_OJT_RESULT
        SET
            OJT_DT = #{ojtDt},
            STUDY_CONT_A = #{studyContA},
            STUDY_CONT_B =  #{studyContB},
            START_TIME = #{startTime},
            END_TIME = #{endTime},
            EDU_FULL_TIME = CEILING(TIME_TO_SEC((SELECT DATE_FORMAT(TIMEDIFF(#{endTime}, #{startTime}), '%H:%m'))) / 3600),
            EDU_TIME =  IF(CEILING(TIME_TO_SEC((SELECT DATE_FORMAT(TIMEDIFF(#{endTime}, #{startTime}), '%H:%m'))) / 3600) > 2, 2,CEILING(TIME_TO_SEC((SELECT DATE_FORMAT(TIMEDIFF(#{endTime}, #{startTime}), '%H:%m'))) / 3600)),
            EDU_TIME_HALF = IF((CEILING(TIME_TO_SEC((SELECT DATE_FORMAT(TIMEDIFF(#{endTime}, #{startTime}), '%H:%m'))) / 3600) / 2) > 2, 2, (CEILING(TIME_TO_SEC((SELECT DATE_FORMAT(TIMEDIFF(#{endTime}, #{startTime}), '%H:%m'))) / 3600) / 2)),
            LOCATION = #{location},
            CONTENT = #{content},
            ETC = #{etc},
            SAVE_TYPE = #{saveType},
            SAVE_TYPE_TEXT = #{saveTypeText},
            REG_EMP_SEQ = #{regEmpSeq},
            REG_EMP_NAME = #{regEmpName}
        WHERE
            OJT_RESULT_SN = #{ojtResultSn}
    </update>

    <update id="setOjtResultUpdate" parameterType="map">
        /*setOjtResultUpdate*/
        UPDATE
            CAMPUS.DJ_OJT_RESULT
        SET
            FILE_SN = #{file_no}
        WHERE
            OJT_RESULT_SN = #{ojtResultSn}
    </update>

    <insert id="setOjtUserInsert" parameterType="map">
        /* setOjtUserInsert */
        INSERT INTO CAMPUS.DJ_OJT_USER
            (
                OJT_RESULT_SN,
                STUDY_INFO_SN,
                <if test='studyClassSn != null and studyClassSn != ""'>
                    OJT_CLASS_SN,
                </if>
                <if test='studyClassText != null and studyClassText != ""'>
                    OJT_CLASS_TEXT,
                </if>
                OJT_EMP_SEQ,
                OJT_EMP_NAME,
                OJT_DEPT_NAME,
                OJT_TEAM_NAME,
                OJT_POSITION_NAME,
                OJT_DUTY_NAME,
                OJT_RESULT_DT,
                REAL_OJT_TIME

            )
        VALUES
            (
                #{ojtResultSn},
                #{studyInfoSn},
                <if test='studyClassSn != null and studyClassSn != ""'>
                    #{studyClassSn},
                </if>
                <if test='studyClassText != null and studyClassText != ""'>
                    #{studyClassText},
                </if>
                #{empSeq},
                #{studyEmpName},
                #{studyDeptName},
                #{studyTeamName},
                #{studyPositionName},
                #{studyDutyName},
                #{ojtDt},
                <if test='studyClassSn == "5"'>
                    #{realEduUserTime}
                </if>
                <if test='studyClassSn == "4"'>
                    #{realEduMngTime}
                </if>
            )
    </insert>

    <insert id="setStudyPropagInsert" parameterType="map">
        /* setStudyPropagInsert */
        INSERT INTO CAMPUS.DJ_STUDY_PROPAG
            (
                STUDY_INFO_SN,
                PROPAG_DT,
                START_TIME,
                END_TIME,
                EDU_TIME,
                EDU_USER_TIME,
                EDU_MNG_TIME,
                LOCATION,
                SAVE_TYPE,
                PROPAG_CONTENT,
                REG_EMP_SEQ,
                REG_EMP_NAME
            )
        VALUES
            (
                #{studyInfoSn},
                #{propagDt},
                #{startTime},
                #{endTime},
                ROUND(TIME_TO_SEC((SELECT TIMEDIFF(#{endTime}, #{startTime}))) / 3600, 1),
                ROUND(TIME_TO_SEC((SELECT TIMEDIFF(#{endTime}, #{startTime}))) / 3600, 1),
                ROUND((TIME_TO_SEC((SELECT TIMEDIFF(#{endTime}, #{startTime}))) / 3600)*1.5, 1),
                #{location},
                #{saveType},
                #{propagContent},
                #{regEmpSeq},
                #{regEmpName}
            )
        <selectKey keyProperty="studyPropagSn" resultType="Integer" order="BEFORE">
            SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'CAMPUS' AND TABLE_NAME = 'DJ_STUDY_PROPAG'
        </selectKey>
    </insert>

    <update id="setStudyPropagModify" parameterType="map">
        /* setStudyPropagModify */
        UPDATE
            CAMPUS.DJ_STUDY_PROPAG
        SET
            PROPAG_DT = #{propagDt},
            START_TIME = #{startTime},
            END_TIME = #{endTime},
            EDU_TIME = ROUND(TIME_TO_SEC((SELECT TIMEDIFF(#{endTime}, #{startTime}))) / 3600,1),
            EDU_USER_TIME = ROUND(TIME_TO_SEC((SELECT TIMEDIFF(#{endTime}, #{startTime}))) / 3600, 1),
            EDU_MNG_TIME = ROUND(TIME_TO_SEC((SELECT TIMEDIFF(#{endTime}, #{startTime}))) / 3600 * 1.5, 1),
            LOCATION = #{location},
            SAVE_TYPE = #{saveType},
            PROPAG_CONTENT = #{propagContent},
            REG_EMP_SEQ = #{regEmpSeq},
            REG_EMP_NAME = #{regEmpName}
        WHERE
            STUDY_PROPAG_SN = #{studyPropagSn}
    </update>

    <insert id="setPropagUserInsert" parameterType="map">
        /* setPropagUserInsert */
        INSERT INTO CAMPUS.DJ_PROPAG_USER
            (
                STUDY_PROPAG_SN,
                STUDY_INFO_SN,
                <if test='studyClassSn != null and studyClassSn != ""'>
                    PROPAG_CLASS_SN,
                </if>
                <if test='studyClassText != null and studyClassText != ""'>
                    PROPAG_CLASS_TEXT,
                </if>
                PROPAG_EMP_SEQ,
                PROPAG_EMP_NAME,
                PROPAG_DEPT_NAME,
                PROPAG_TEAM_NAME,
                PROPAG_POSITION_NAME,
                PROPAG_DUTY_NAME,
                REG_DT,
                PROPAG_RESULT_DT,
                REAL_EDU_TIME
            )
        VALUES
            (
                #{studyPropagSn},
                #{studyInfoSn},
                <if test='studyClassSn != null and studyClassSn != ""'>
                    #{studyClassSn},
                </if>
                <if test='studyClassText != null and studyClassText != ""'>
                    #{studyClassText},
                </if>
                #{empSeq},
                #{studyEmpName},
                #{studyDeptName},
                #{studyTeamName},
                #{studyPositionName},
                #{studyDutyName},
                NOW(),
                #{propagDt},
            <if test='studyClassSn == "5"'>
                 #{realEduUserTime}
            </if>
            <if test='studyClassSn == "4"'>
                #{realEduMngTime}
            </if>
            )
    </insert>

    <delete id="setPropagUserDelete" parameterType="map">
        /* setPropagUserDelete */
        DELETE FROM
            CAMPUS.DJ_PROPAG_USER
        WHERE
            STUDY_PROPAG_SN = #{studyPropagSn}
    </delete>

    <delete id="setPropagDelete" parameterType="map">
        /* setPropagDelete */
        DELETE FROM
            CAMPUS.DJ_STUDY_PROPAG
        WHERE
            STUDY_PROPAG_SN = #{pk}
    </delete>

    <delete id="delPropagUserDelete" parameterType="map">
        /*delPropagUserDelete*/
        DELETE FROM CAMPUS.DJ_PROPAG_USER WHERE STUDY_PROPAG_SN = #{pk}
    </delete>

    <update id="setResultPropagUpd" parameterType="map">
        /* setResultPropagUpd */
        UPDATE
            CAMPUS.DJ_STUDY_PROPAG A
        SET
            EDU_USER_TIME = #{user}
            , EDU_MNG_TIME = #{mng}
        WHERE
            STUDY_PROPAG_SN = #{studyPropagSn}
    </update>

    <update id="setResultPropagUserUpd" parameterType="map">
        /* setResultPropagUserUpd */
        UPDATE
            CAMPUS.DJ_PROPAG_USER A
        SET
            REAL_EDU_TIME = (CASE WHEN A.PROPAG_CLASS_SN = 4 THEN #{mng} ELSE #{user} END)
        WHERE
            STUDY_PROPAG_SN = #{studyPropagSn}
    </update>

    <insert id="setOpenStudyInfoIns" parameterType="map">
        /* setOpenStudyInfoIns */
        INSERT INTO CAMPUS.DJ_OPENSTUDY_INFO
            (
                OPEN_STUDY_NAME,
                OPEN_STUDY_DT,
                START_TIME,
                END_TIME,
                EDU_TIME,
                OPEN_STUDY_DETAIL,
                OPEN_STUDY_LOCATION,
                REG_EMP_SEQ,
                REG_EMP_NAME
            )
        VALUES
            (
                #{openStudyName},
                #{openStudyDt},
                #{startTime},
                #{endTime},
                #{eduTime},
                #{openStudyDetail},
                #{openStudyLocation},
                #{regEmpSeq},
                #{regEmpName}
            )
        <selectKey keyProperty="openStudyKey" resultType="Integer" order="BEFORE">
            SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'CAMPUS' AND TABLE_NAME = 'DJ_OPENSTUDY_INFO'
        </selectKey>
    </insert>

    <update id="setOpenStudyInfoUpd" parameterType="map">
        /* setOpenStudyInfoUpd */
        UPDATE
            CAMPUS.DJ_OPENSTUDY_INFO
        SET
            OPEN_STUDY_NAME = #{openStudyName},
            OPEN_STUDY_DT = #{openStudyDt},
            START_TIME = #{startTime},
            END_TIME = #{endTime},
            EDU_TIME = #{eduTime},
            OPEN_STUDY_DETAIL = #{openStudyDetail},
            OPEN_STUDY_LOCATION = #{openStudyLocation}
        WHERE
            OPEN_STUDY_INFO_SN = #{pk}
    </update>

    <update id="setOpenNextStep" parameterType="map">
        /* setOpenNextStep */
        UPDATE
            CAMPUS.DJ_OPENSTUDY_INFO
        SET
            STEP = #{step}
        WHERE
            OPEN_STUDY_INFO_SN = #{pk}
    </update>

    <insert id="setOpenStudyUser" parameterType="map">
        /* setOpenStudyUser */
        INSERT INTO CAMPUS.DJ_OPENSTUDY_USER
            (
                OPEN_STUDY_INFO_SN,
                REG_EMP_SEQ,
                REG_EMP_NAME,
                REG_DEPT_NAME,
                REG_TEAM_NAME,
                REG_POSITION_NAME,
                REG_DUTY_NAME
            )
        VALUES
            (
                #{pk},
                #{regEmpSeq},
                #{regEmpName},
                #{regDeptName},
                #{regTeamSeq},
                #{regPositionName},
                #{regDutyName}
            )
    </insert>

    <update id="setOpenStudyResultUpd" parameterType="map">
        /* setOpenStudyResultUpd */
        UPDATE
            CAMPUS.DJ_OPENSTUDY_INFO
        SET
            OPEN_STUDY_NAME_RES = #{resOpenStudyName},
            OPEN_STUDY_DT_RES = #{resOpenStudyDt},
            START_TIME_RES = #{resStartTime},
            END_TIME_RES = #{resEndTime},
            EDU_TIME_RES = #{resEduTime},
            OPEN_STUDY_AMT = #{openStudyAmt},
            OPEN_STUDY_AMT_TEXT = #{openStudyAmtText},
            OPEN_STUDY_RESULT = #{openStudyResult},
            STEP = #{step}
        WHERE
            OPEN_STUDY_INFO_SN = #{pk}
    </update>

    <update id="setOpenStudyUserResultUpd" parameterType="map">
        /* setOpenStudyUserResultUpd */
        UPDATE
            CAMPUS.DJ_OPENSTUDY_USER
        SET
            USER_CLASS = #{userClass},
            USER_CLASS_TEXT = #{userClassText},
            PART_YN = #{partYN}
        WHERE
            OPEN_STUDY_USER_SN = #{pk}
    </update>

    <delete id="delOpenStudyUser" parameterType="map">
        /* delOpenStudyUser */
        DELETE FROM
            CAMPUS.DJ_OPENSTUDY_USER
        WHERE
            OPEN_STUDY_USER_SN = #{openStudyUserSn}
    </delete>

    <update id="setOpenStudyCertReq" parameterType="map">
        /* setOpenStudyCertReq */
        UPDATE
            CAMPUS.DJ_OPENSTUDY_INFO
        SET
            STATUS = #{status}
            <if test='"100".equals(status)'>
                , APPROVAL_EMP_SEQ = #{regEmpSeq}
                , APPROVAL_EMP_NAME = #{regEmpName}
                , APPROVAL_RESULT_DATE = NOW()
            </if>
        WHERE
            OPEN_STUDY_INFO_SN = #{pk}
    </update>

    <insert id="setCommonEduIns" parameterType="map">
        /* setCommonEduIns */
        INSERT INTO CAMPUS.DJ_COMMON_EDU
            (
                COMMON_CLASS,
                COMMON_CLASS_TEXT,
                START_DT,
                END_DT,
                EDU_NAME,
                EDU_TIME,
                EDU_LOCATION,
                EDU_TITLE,
                EDU_DETAIL,
                STATUS,
                REG_EMP_SEQ,
                REG_EMP_NAME
            )
        VALUES
            (
                #{commonClass},
                #{commonClassText},
                #{startDt},
                #{endDt},
                #{eduName},
                #{eduTime},
                #{eduLocation},
                #{eduTitle},
                #{eduDetail},
                #{status},
                #{regEmpSeq},
                #{regEmpName}
            )
    </insert>

    <update id="setCommonEduUpd" parameterType="map">
        /* setCommonEduUpd */
        UPDATE
            CAMPUS.DJ_COMMON_EDU
        SET
            COMMON_CLASS = #{commonClass},
            COMMON_CLASS_TEXT = #{commonClassText},
            START_DT = #{startDt},
            END_DT = #{endDt},
            EDU_NAME = #{eduName},
            EDU_TIME = #{eduTime},
            EDU_LOCATION = #{eduLocation},
            EDU_TITLE = #{eduTitle},
            EDU_DETAIL = #{eduDetail},
            STATUS = #{status}
        WHERE
            COMMON_EDU_SN = #{pk}
    </update>

    <insert id="setCommonEduAddUserAll" parameterType="map">
        /* setCommonEduAddUserAll */
        INSERT INTO CAMPUS.DJ_COMMON_EDU_USER
            (COMMON_EDU_SN, REG_EMP_SEQ, REG_EMP_NAME, REG_DEPT_NAME, REG_TEAM_NAME, REG_POSITION_NAME, REG_DUTY_NAME, REAR_EDU_TIME)
        SELECT
            #{pk} AS COMMON_EDU_SN,
            HEI.EMP_SEQ AS REG_EMP_SEQ,
            HEI.EMP_NAME_KR AS REG_EMP_NAME,
            CASE WHEN HDI.DEPT_LEVEL = 2 THEN (SELECT DEPT_NAME FROM CAM_HR.DJ_DEPT_INFO DI WHERE HDI.PARENT_DEPT_SEQ = DI.DEPT_SEQ) ELSE HEI.DEPT_NAME END AS REG_DEPT_NAME,
            CASE WHEN HDI.DEPT_LEVEL = 2 THEN HEI.DEPT_NAME ELSE "" END AS REG_TEAM_NAME,
            HEI.POSITION_NAME AS REG_POSITION_NAME,
            HEI.DUTY_NAME AS REG_DUTY_NAME,
            (SELECT EDU_TIME FROM CAMPUS.DJ_COMMON_EDU SCCEU WHERE COMMON_EDU_SN = #{pk}) AS REAR_EDU_TIME
        FROM
            CAM_HR.DJ_EMP_INFO HEI
        LEFT JOIN
            CAM_HR.DJ_DEPT_INFO HDI ON HEI.DEPT_SEQ = HDI.DEPT_SEQ
        WHERE
            (DIVISION = 0 OR (DIVISION = 4 AND DIVISION_SUB != 3))
        AND WORK_STATUS_CODE = 'Y'
        AND TEMP_DIVISION = 'N'
        AND EMP_SEQ NOT IN (SELECT REG_EMP_SEQ AS EMP_SEQ FROM CAMPUS.DJ_COMMON_EDU_USER SCCEU WHERE COMMON_EDU_SN = #{pk} AND ACTIVE = 'Y')
        <if test='userList != null and !"".equals(userList)'>
            AND EMP_SEQ IN (${userList})
        </if>
        ORDER BY EMP_NAME_KR
    </insert>

    <update id="setCommonEduUserUpd" parameterType="map">
        /* setCommonEduUserUpd */
        UPDATE
            CAMPUS.DJ_COMMON_EDU_USER
        SET
            <choose>
                <when test="partYn != null and !''.equals(partYn)">
                    PART_YN = #{partYn}
                </when>
                <when test="active != null and !''.equals(active)">
                    ACTIVE = #{active}
                </when>
            </choose>
        WHERE
            COMMON_EDU_SN = #{pk}
        AND COMMON_EDU_USER_SN in (${userList})
    </update>

    <update id="setCommonEduUserTimeUpd" parameterType="map">
        /* setCommonEduUserTimeUpd */
        UPDATE
            CAMPUS.DJ_COMMON_EDU_USER
        SET
            REAR_EDU_TIME = #{eduTime}
        WHERE
            COMMON_EDU_USER_SN = #{pk}
    </update>

    <insert id="setTargetInsert" parameterType="map">
        /* setTargetInsert */
        INSERT INTO CAMPUS.DJ_EDU_TARGET
            (
                TARGET_YEAR,
                TARGET_CODE,
                LOGIN_ID,
                REG_EMP_SEQ
            )
        VALUES
            (
                #{targetYear},
                #{targetCode},
                #{loginId},
                #{empSeq}
            )
    </insert>

    <insert id="setTargetDetailInsert" parameterType="map">
        /* setTargetDetailInsert */
        INSERT INTO CAMPUS.DJ_EDU_TARGET_DETAIL
            (
                EDU_TARGET_ID,
                EDU_CATEGORY_DETAIL_ID,
                DUTY_CLASS,
                REG_EMP_SEQ
            )
        VALUES
        <foreach collection="eduCategoryDetailIdList" item="item" separator=" , ">
            (
                (SELECT EDU_TARGET_ID FROM CAMPUS.DJ_EDU_TARGET WHERE TARGET_YEAR = #{targetYear} AND REG_EMP_SEQ = #{empSeq}),
                #{item.eduCategoryDetailId},
                #{dutyClass},
                #{empSeq}
            )
        </foreach>
    </insert>

    <update id="setEduTargetDetailUpdate" parameterType="map">
        /* setEduTargetDetailUpdate */
        UPDATE
            CAMPUS.DJ_EDU_TARGET_DETAIL
        SET
            TARGET_CLASS = #{classNum}
        WHERE
            EDU_TARGET_DETAIL_ID IN
        <foreach collection="eduTargetDetailIdList" item="item" open="(" separator="," close=")">
            #{item.eduTargetDetailId}
        </foreach>
    </update>

    <delete id="setTargetDetailDelete" parameterType="map">
        /* setTargetDetailDelete */
        DELETE FROM
            CAMPUS.DJ_EDU_TARGET_DETAIL
        WHERE
            EDU_TARGET_ID = (
                SELECT
                    EDU_TARGET_ID
                FROM
                    CAMPUS.DJ_EDU_TARGET
                WHERE
                    TARGET_YEAR = #{targetYear}
                AND REG_EMP_SEQ = #{empSeq}
            )
        AND DUTY_CLASS = #{dutyClass}
    </delete>

    <insert id="setEduPlanInsert" parameterType="map">
        /* setEduPlanInsert */
        INSERT INTO CAMPUS.DJ_EDU_PLAN
            (
                EDU_CATEGORY_ID,
                TARGET_YEAR,
                DUTY_CLASS,
                EDU_PLAN,
                REG_EMP_SEQ
            )
        VALUES
            (
                #{eduCategoryId},
                #{targetYear},
                #{dutyClass},
                #{eduPlan},
                #{empSeq}
            )
    </insert>

    <update id="setEduPlanUpdate" parameterType="map">
        /* setEduPlanUpdate */
        UPDATE
            CAMPUS.DJ_EDU_PLAN
        SET
            EDU_PLAN = #{eduPlan}
        WHERE
            EDU_PLAN_ID = #{eduPlanId}
    </update>

    <update id="updateEduInfoApprStat" parameterType="map">
        /* updateEduInfoApprStat */
        UPDATE
            CAMPUS.DJ_EDU_INFO
        SET
            <if test='docId != null and !"".equals(docId)'>
                DOC_ID = #{docId},
            </if>
            STATUS = ${status},
            APPROVAL_SEND_DATE = DATE_FORMAT(NOW(), '%Y-%m-%d'),
            APPROVAL_EMP_SEQ = #{empSeq}
        WHERE
            EDU_INFO_ID = #{eduInfoId}
    </update>

    <update id="updateEduInfoFinalApprStat" parameterType="map">
        /* updateEduInfoFinalApprStat */
        UPDATE
            CAMPUS.DJ_EDU_INFO
        SET
            STATUS = ${status},
            APPROVAL_EMP_SEQ = #{empSeq}
        WHERE
            EDU_INFO_ID = #{eduInfoId}
    </update>

    <update id="updateEduResultApprStat" parameterType="map">
        /* updateEduResultApprStat */
        UPDATE
        CAMPUS.DJ_EDU_RESULT
        SET
        <if test='docId != null and !"".equals(docId)'>
            DOC_ID = #{docId},
        </if>
        STATUS = ${status},
        APPROVAL_SEND_DATE = DATE_FORMAT(NOW(), '%Y-%m-%d'),
        APPROVAL_EMP_SEQ = #{empSeq}
        WHERE
        EDU_INFO_ID = #{eduInfoId}
    </update>

    <update id="updateEduResultFinalApprStat" parameterType="map">
        /* updateEduResultFinalApprStat */
        UPDATE
            CAMPUS.DJ_EDU_RESULT
        SET
            STATUS = ${status},
            APPROVAL_EMP_SEQ = #{empSeq},
            MNG_CHECK = 'Y',
            REAL_EDU_TIME = #{realEduTime}
        WHERE
            EDU_INFO_ID = #{eduInfoId}
    </update>

    <update id="updateApprStat" parameterType="map">
        /* updateApprStat */
        UPDATE
            CAMPUS.DJ_EDU_TARGET
        SET
            STATUS = ${status}
        WHERE
            TARGET_YEAR = #{targetYear}
        AND REG_EMP_SEQ = #{empSeq}
    </update>

    <update id="updateApprStatMaster" parameterType="map">
        /*updateApprStatMaster*/
        UPDATE
            CAMPUS.DJ_EDU_TARGET
        SET
            STATUS = 100,
            MNG_STAT = 'Y',
            APPROVAL_RESULT_DATE = now()
        WHERE
            TARGET_YEAR = #{targetYear}
          AND REG_EMP_SEQ = #{empSeq}
    </update>

    <update id="updateStudyApprStat" parameterType="map">
        /* updateStudyApprStat */
        UPDATE
            CAMPUS.DJ_STUDY_INFO
        SET
        <if test='docId != null and !"".equals(docId)'>
            DOC_ID = #{docId},
        </if>
            STATUS = #{status}
        WHERE
            STUDY_INFO_SN = #{studyInfoSn}
    </update>

    <update id="updateStudyFinalApprStat" parameterType="map">
        /* updateStudyFinalApprStat */
        UPDATE
            CAMPUS.DJ_STUDY_INFO
        SET
            STATUS = #{status},
            APPROVAL_EMP_SEQ = #{empSeq},
            APPROVAL_DATE = DATE_FORMAT(NOW(), '%Y-%m-%d')
        WHERE
            STUDY_INFO_SN = #{studyInfoSn}
    </update>

    <update id="updateStudyResApprStat" parameterType="map">
        /* updateStudyResApprStat */
        UPDATE
            CAMPUS.DJ_STUDY_RESULT
        SET
        <if test='docId != null and !"".equals(docId)'>
            DOC_ID = #{docId},
        </if>
        STATUS = #{status}
        WHERE
        STUDY_RESULT_SN = #{studyResultSn}
    </update>

    <update id="updatePropagResApprStat" parameterType="map">
        /* updatePropagResApprStat */
        UPDATE
            CAMPUS.DJ_STUDY_INFO
        SET
        <if test='docId != null and !"".equals(docId)'>
            RES_DOC_ID = #{docId},
        </if>
            RES_STATUS = #{status}
        WHERE
            STUDY_INFO_SN = #{studyInfoSn}
    </update>


    <update id="updatePropagResFinalApprStat" parameterType="map">
        /* updatePropagResFinalApprStat */
        UPDATE
            CAMPUS.DJ_STUDY_INFO
        SET
            RES_STATUS = #{status},
            RES_APPROVAL_EMP_SEQ = #{empSeq},
            RES_APPROVAL_DATE = DATE_FORMAT(NOW(), '%Y-%m-%d')
        WHERE
            STUDY_INFO_SN = #{studyInfoSn}
    </update>

    <update id="updateStudyResFinalApprStat" parameterType="map">
        /* updateStudyResFinalApprStat */
        UPDATE
            CAMPUS.DJ_STUDY_RESULT
        SET
            STATUS = #{status},
            APPROVAL_EMP_SEQ = #{empSeq},
            APPROVAL_DATE = DATE_FORMAT(NOW(), '%Y-%m-%d')
        WHERE
            STUDY_RESULT_SN = #{studyResultSn}
    </update>

    <insert id="setEduCode" parameterType="map">
        /* setEduCode */
        INSERT INTO CAMPUS.DJ_CAMPUS_CODE
            (
                CAMPUS_GROUP_CODE_ID,
                CAMPUS_MD_CODE,
                CAMPUS_MD_CODE_NM,
                CAMPUS_DT_CODE,
                CAMPUS_DT_CODE_NM,
                REG_EMP_SEQ
            )
        VALUES
            (
                #{groupCode},
                #{midleCode},
                #{midleCodeName},
                (SELECT IFNULL(MAX(SCCC.CAMPUS_DT_CODE), 0)+1 FROM CAMPUS.DJ_CAMPUS_CODE SCCC WHERE SCCC.CAMPUS_MD_CODE = #{midleCode}),
                #{reqText},
                #{regEmpSeq}
            )
    </insert>

    <insert id="setEduCategory" parameterType="map">
        /* setEduCategory */
        INSERT INTO CAMPUS.DJ_EDU_CATEGORY
            (
                EDU_CATEGORY_NAME,
                LARGE_CATEGORY_ID,
                LARGE_CATEGORY_NAME,
                REG_EMP_SEQ
            )
        VALUES
            (
                #{reqText},
                #{largeCategoryId},
                #{largeCategoryName},
                #{regEmpSeq}
            )
    </insert>

    <insert id="setEduCategoryDetail" parameterType="map">
        /* setEduCategoryDetail */
        INSERT INTO CAMPUS.DJ_EDU_CATEGORY_DETAIL
            (
                EDU_CATEGORY_DETAIL_NAME,
                EDU_CATEGORY_ID,
                EDU_CATEGORY_NAME,
                LEVEL_ID,
                LEVEL_NAME,
                REG_EMP_SEQ
            )
        VALUES
            (
                #{reqText},
                #{eduCategoryId},
                #{eduCategoryName},
                #{level},
                #{levelName},
                #{regEmpSeq}
            )
    </insert>

    <update id="setEduCodeUpd" parameterType="map">
        /* setEduCodeUpd */
        UPDATE
            CAMPUS.DJ_CAMPUS_CODE
        SET
            CAMPUS_DT_CODE_NM = #{reqText}
        WHERE
            CAMPUS_GROUP_CODE_ID = #{groupCode}
        AND CAMPUS_DT_CODE = #{pk}
    </update>

    <update id="setEduCategoryUpd" parameterType="map">
        /* setEduCategoryUpd */
        UPDATE
            CAMPUS.DJ_EDU_CATEGORY
        SET
            EDU_CATEGORY_NAME = #{reqText}
        WHERE
            EDU_CATEGORY_ID = #{pk}
    </update>

    <update id="setEduCategoryDetailUpd" parameterType="map">
        /* setEduCategoryDetailUpd */
        UPDATE
            CAMPUS.DJ_EDU_CATEGORY_DETAIL
        SET
            EDU_CATEGORY_DETAIL_NAME = #{reqText},
            LEVEL_ID = #{level},
            LEVEL_NAME = #{levelName}
        WHERE
            EDU_CATEGORY_DETAIL_ID = #{pk}
    </update>

    <update id="setEduCodeDel" parameterType="map">
        /* setEduCodeDel */
        UPDATE
            CAMPUS.DJ_CAMPUS_CODE
        SET
            ACTIVE = #{active}
        WHERE
            CAMPUS_GROUP_CODE_ID = #{groupCode}
        AND CAMPUS_DT_CODE IN (${pk})
    </update>

    <update id="setEduCategoryDel" parameterType="map">
        /* setEduCategoryDel */
        UPDATE
            CAMPUS.DJ_EDU_CATEGORY
        SET
            ACTIVE = #{active}
        WHERE
            EDU_CATEGORY_ID IN (#{pk})
    </update>

    <update id="setEduCategoryDetailDel" parameterType="map">
        /* setEduCategoryDetailDel */
        UPDATE
            CAMPUS.DJ_EDU_CATEGORY_DETAIL
        SET
            ACTIVE = #{active}
        WHERE
            EDU_CATEGORY_DETAIL_ID IN (#{pk})
    </update>

    <insert id="setDutyInfoIns" parameterType="map">
        /* setDutyInfoIns */
        INSERT INTO CAMPUS.DJ_DUTY_INFO
            (
                DUTY_YEAR,
                DUTY_MONTH,
                DUTY_NAME,
                OUTLINE_NAME,
                OUTLINE_DETAIL,
                INTERNAL,
                EXTERNAL,
                APP_LINE,
                ABILITY_A,
                ABILITY_B,
                ABILITY_C,
                ABILITY_D,
                ABILITY_E,
                RESPONSIBILITY,
                REG_EMP_SEQ,
                REG_EMP_NAME
            )
        VALUES
            (
                LEFT(#{dutyMonth}, 4),
                #{dutyMonth},
                #{dutyName},
                #{outlineName},
                #{outlineDetail},
                #{internal},
                #{external},
                #{appLine},
                #{abilityA},
                #{abilityB},
                #{abilityC},
                #{abilityD},
                #{abilityE},
                #{responsibility},
                #{regEmpSeq},
                #{regEmpName}
            )

        <selectKey keyProperty="dutyInfoSn" resultType="Integer" order="BEFORE">
            SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'CAMPUS' AND TABLE_NAME = 'DJ_DUTY_INFO'
        </selectKey>
    </insert>

    <insert id="setDutyInfoUpd" parameterType="map">
        /* setDutyInfoUpd */
        UPDATE
            CAMPUS.DJ_DUTY_INFO
        SET
            DUTY_MONTH = #{dutyMonth},
            DUTY_NAME = #{dutyName},
            OUTLINE_NAME = #{outlineName},
            OUTLINE_DETAIL = #{outlineDetail},
            INTERNAL = #{internal},
            EXTERNAL = #{external},
            APP_LINE = #{appLine},
            ABILITY_A = #{abilityA},
            ABILITY_B = #{abilityB},
            ABILITY_C = #{abilityC},
            ABILITY_D = #{abilityD},
            ABILITY_E = #{abilityE},
            RESPONSIBILITY = #{responsibility}
        WHERE
            DUTY_INFO_SN = #{pk}
    </insert>

    <update id="setTargetCertReq" parameterType="map">
        /* setTargetCertReq */
        UPDATE
            CAMPUS.DJ_EDU_TARGET
        SET
            STATUS = #{status}
        <if test='"100".equals(status)'>
            , APPROVAL_EMP_SEQ = #{regEmpSeq}
            , APPROVAL_EMP_NAME = #{regEmpName}
            , APPROVAL_RESULT_DATE = NOW()
        </if>
        <if test='"Y".equals(returnStat)'>
            , LD_STAT = 'N'
        </if>
        WHERE
            TARGET_YEAR = #{targetYear}
        AND REG_EMP_SEQ = #{empSeq}
    </update>

    <update id="setDutyCertReq" parameterType="map">
        /* setDutyCertReq */
        UPDATE
            CAMPUS.DJ_DUTY_INFO
        SET
            STATUS = #{status}
            <if test='"100".equals(status)'>
                , APPROVAL_EMP_SEQ = #{regEmpSeq}
                , APPROVAL_EMP_NAME = #{regEmpName}
                , APPROVAL_RESULT_DATE = NOW()
            </if>
            <if test='"Y".equals(returnStat)'>
                , LD_STAT = 'N'
            </if>
        WHERE
            DUTY_INFO_SN = #{pk}
    </update>

    <update id="setDutyCertReqMaster" parameterType="map">
        /*setDutyCertReqMaster*/
        UPDATE
            CAMPUS.DJ_DUTY_INFO
        SET
            STATUS = 100
            , APPROVAL_EMP_SEQ = #{regEmpSeq}
            , APPROVAL_EMP_NAME = #{regEmpName}
            , APPROVAL_RESULT_DATE = NOW()
            , MNG_STAT = 'Y'
        WHERE
            DUTY_INFO_SN = #{pk}
    </update>

    <select id="getApprEmpInfo" parameterType="map" resultType="map">
        /*getApprEmpInfo*/
        SELECT
            *
        FROM
            CAM_HR.DJ_EMP_INFO
        WHERE 1=1
          AND DEPT_SEQ =
              <choose>
                  <when test='"ld".equals(type)'>
                      ( SELECT
                          CASE
                              WHEN B.PARENT_DEPT_SEQ = '1000' THEN C.DEPT_SEQ
                              ELSE B.PARENT_DEPT_SEQ
                          END AS DEPT_SEQ
                      FROM CAM_HR.DJ_EMP_INFO A
                      LEFT JOIN CAM_HR.DJ_DEPT_INFO B on A.DEPT_SEQ = B.DEPT_SEQ
                      LEFT JOIN CAM_HR.DJ_DEPT_INFO C ON C.DEPT_SEQ = B.PARENT_DEPT_SEQ
                      WHERE A.EMP_SEQ = #{regEmpSeq} )
                  </when>
                  <otherwise>
                      ( SELECT DEPT_SEQ FROM CAM_HR.DJ_EMP_INFO WHERE EMP_SEQ = #{regEmpSeq} )
                  </otherwise>
              </choose>
          AND DUTY_CODE IN (${dutyCode})
          OR EMP_SEQ = (SELECT EMP_SEQ FROM CAM_HR.DJ_EMP_TMP_DUTY WHERE TMP_DEPT_SEQ = ( SELECT DEPT_SEQ FROM CAM_HR.DJ_EMP_INFO WHERE EMP_SEQ = #{regEmpSeq}) AND TMP_DUTY_SN IN (${dutyCode}) AND ACTIVE = 'Y')
    </select>

    <update id="setStudyInfoComplete" parameterType="map">
        /*setStudyInfoComplete*/
        UPDATE CAMPUS.DJ_STUDY_INFO
        SET
            ADD_STATUS = "Y"
        WHERE
            STUDY_INFO_SN = #{studyInfoSn}
    </update>

    <update id="setPropagInfoComplete" parameterType="map">
        /*setPropagInfoComplete*/
        UPDATE CAMPUS.DJ_STUDY_PROPAG
        SET
            ADD_STATUS = "Y"
        WHERE
            STUDY_PROPAG_SN = #{studyPropagSn}
    </update>

    <update id="setStudyResultComplete" parameterType="map">
        /*setStudyResultComplete*/
        UPDATE CAMPUS.DJ_STUDY_INFO
        SET
            ADD_STATUS = "C"
        WHERE
            STUDY_INFO_SN = #{studyInfoSn}
    </update>

    <update id="setStudyResultSc" parameterType="map">
        /*setStudyResultSc*/
        UPDATE CAMPUS.DJ_STUDY_INFO
        SET
            ADD_STATUS = "S"
        WHERE
            STUDY_INFO_SN = #{studyInfoSn}
    </update>

    <select id="getStudyResultOne" parameterType="map" resultType="map">
        /*getStudyResultOne*/
        SELECT
            *
        FROM
            CAMPUS.DJ_STUDY_RESULT
        WHERE
            STUDY_INFO_SN = #{pk}
        ORDER BY STUDY_RESULT_SN
        LIMIT 1
    </select>

    <select id="getStudyResultList" parameterType="map" resultType="map">
        /*getStudyResultList*/
        SELECT
            STUDY_CLASS_SN,
            STUDY_CLASS_TEXT,
            STUDY_EMP_SEQ,
            STUDY_EMP_NAME,
            STUDY_DEPT_NAME,
            STUDY_TEAM_NAME,
            STUDY_POSITION_NAME,
            STUDY_DUTY_NAME,
            SUM(STUDY_TIME) as STUDY_TIME,
            COUNT(STUDY_EMP_SEQ) as STUDY_EMP_CNT
        FROM
            CAMPUS.DJ_STUDY_RESULT_USER
        WHERE
            STUDY_INFO_SN = #{pk}
        GROUP BY STUDY_EMP_SEQ
    </select>

    <select id="getStudyUserInfo" parameterType="map" resultType="map">
        /*getStudyUserInfo*/
        SELECT
            *
        FROM
            CAMPUS.DJ_STUDY_USER
        WHERE
            STUDY_INFO_SN = #{studyInfoSn}
        AND
            STUDY_EMP_SEQ = #{studyEmpSeq}
    </select>

    <select id="setStudyResultUserInsert" parameterType="map">
        /*setStudyResultUserInsert*/
        INSERT INTO CAMPUS.DJ_STUDY_RESULT_USER
            (
                STUDY_INFO_SN,
                STUDY_JOURNAL_SN,
                STUDY_EMP_SEQ,
                STUDY_EMP_NAME,
                STUDY_DEPT_NAME,
                STUDY_TEAM_NAME,
                STUDY_POSITION_NAME,
                STUDY_DUTY_NAME,
                STUDY_TIME,
                STUDY_CLASS_SN,
                STUDY_CLASS_TEXT,
                JOURNAL_DT
            )
        VALUES
            (
                #{studyInfoSn},
                #{studyJournalSn},
                #{studyEmpSeq},
                #{studyEmpName},
                #{studyDeptName},
                #{studyTeamName},
                #{studyPositionName},
                #{studyDutyName},
                #{realEduTime},
                #{studyClassSn},
                #{studyClassText},
                #{journalDt}
            )
    </select>

    <select id="getRealEduTimeCheck" parameterType="map" resultType="map">
        /*getRealEduTimeCheck*/
        SELECT
            ou.REG_EMP_NAME,
            ou.REG_EMP_SEQ,
            2 - round(SUM(ou.REAL_EDU_TIME),1) AS remainEduTime,
            (
            SELECT sub.USER_CLASS
            FROM CAMPUS.dj_openstudy_USER sub
            WHERE sub.REG_EMP_SEQ = ou.REG_EMP_SEQ
            AND sub.OPEN_STUDY_INFO_SN = #{pk}
            AND sub.PART_YN = 'Y'
            )AS userClass,
            (
            SELECT edu_time
            FROM CAMPUS.dj_openstudy_INFO
            WHERE OPEN_STUDY_INFO_SN = #{pk}
            ) AS eduTime
        FROM
            CAMPUS.dj_openstudy_info oi
        LEFT JOIN CAMPUS.dj_openstudy_USER ou ON oi.OPEN_STUDY_INFO_SN = ou.OPEN_STUDY_INFO_SN
        WHERE
          ou.REG_EMP_SEQ IN(
            SELECT
                sub.REG_EMP_SEQ
            FROM
                CAMPUS.dj_openstudy_USER sub
            WHERE
                sub.OPEN_STUDY_INFO_SN = #{pk}
            AND
                sub.PART_YN = 'Y'
        )
        AND WEEK(oi.open_study_dt, 7) = (SELECT WEEK(open_study_dt, 7) FROM CAMPUS.dj_openstudy_info WHERE OPEN_STUDY_INFO_SN = #{pk})
        GROUP BY
            ou.REG_EMP_SEQ;
    </select>

    <delete id="deleteStudyResultUser" parameterType="map">
        /*deleteStudyResultUser*/
        DELETE
        FROM
            CAMPUS.DJ_STUDY_RESULT_USER
        WHERE
            STUDY_JOURNAL_SN = #{studyJournalSn}
    </delete>

    <delete id="deleteOjtResult" parameterType="map">
        /*deleteOjtResult*/
        DELETE FROM CAMPUS.DJ_OJT_RESULT
        WHERE
            OJT_RESULT_SN = #{ojtResultSn}
    </delete>

    <delete id="deleteOjtUser" parameterType="map">
        /*deleteOjtUser*/
        DELETE FROM CAMPUS.DJ_OJT_USER
        WHERE
            OJT_RESULT_SN = #{ojtResultSn}
    </delete>

    <select id="getOpenStudyUserDoubleChk" parameterType="map" resultType="boolean">
        /*getOpenStudyUserDoubleChk*/
        SELECT
            CASE WHEN COUNT(*) > 0 THEN 1
                 ELSE 0
                END
        FROM
            CAMPUS.DJ_OPENSTUDY_USER COSU
        LEFT JOIN
            CAM_HR.DJ_EMP_INFO B ON COSU.REG_EMP_SEQ = B.EMP_SEQ
        WHERE
            OPEN_STUDY_INFO_SN = #{pk}
          AND
            COSU.REG_EMP_SEQ = #{regEmpSeq}
    </select>

    <update id="setOpenStudyRealEduTimeUpd" parameterType="map">
        /* setOpenStudyRealEduTimeUpd */
        UPDATE
            CAMPUS.DJ_OPENSTUDY_USER
        SET
            REAL_EDU_TIME = #{realEduTime}
        WHERE
            REG_EMP_SEQ = #{regEmpSeq}
          AND
            user_class = #{userClass}
          and
            open_study_info_sn = #{pk}
    </update>

    <delete id="setStudyUserDelete" parameterType="map">
        /*setStudyUserDelete*/
        DELETE
        FROM
            CAMPUS.DJ_STUDY_USER
        WHERE
            STUDY_INFO_SN = #{pk}
    </delete>

    <select id="getStudyOjtInfoOne" resultType="map" parameterType="map">
        /* getStudyOjtInfoOne */
        SELECT
           *
        FROM
            CAMPUS.dj_ojt_result COR
                LEFT JOIN
            CAM_COMMON.DJ_FILE_INFO DFI
            ON COR.FILE_SN = DFI.FILE_NO
        WHERE OJT_RESULT_SN = #{ojtResultSn}
    </select>

    <select id="getOjtOjtResultCount" resultType="map" parameterType="map">
        /* getOjtOjtResultCount */
        SELECT
            COUNT(OJT_OJT_RESULT_SN) AS ojtResultCount
        FROM CAMPUS.DJ_OJT_OJT_RESULT
        WHERE STUDY_INFO_SN = #{studyInfoSn}
    </select>

    <select id="getEmpTeamOrDept" parameterType="map" resultType="map">
        /*getEmpTeamOrDept*/
        SELECT
            *
        FROM
            CAM_HR.DJ_DEPT_INFO
        WHERE
            DEPT_SEQ = (SELECT DEPT_SEQ FROM CAM_HR.DJ_EMP_INFO WHERE EMP_SEQ = #{empSeq})
    </select>

    <update id="agreeLd" parameterType="map">
        /* agreeLd */
        UPDATE CAMPUS.DJ_EDU_TARGET
        SET
            LD_STAT = 'Y'
        WHERE
            EDU_TARGET_ID = #{eduTargetId}
    </update>

    <update id="agreeMng" parameterType="map">
        /* agreeLd */
        UPDATE CAMPUS.DJ_EDU_TARGET
        SET
            MNG_STAT = 'Y'
        WHERE
            EDU_TARGET_ID = #{eduTargetId}
    </update>

    <update id="agreeDutyLd" parameterType="map">
        /*agreeDutyLd*/
        UPDATE CAMPUS.DJ_DUTY_INFO
        SET
            LD_STAT = 'Y'
        WHERE
            DUTY_INFO_SN = #{dutyInfoSn}
    </update>

    <update id="agreeDutyMng" parameterType="map">
        /*agreeDutyMng*/
        UPDATE CAMPUS.DJ_DUTY_INFO
        SET
            MNG_STAT = 'Y'
        WHERE
            DUTY_INFO_SN = #{dutyInfoSn}
    </update>

    <select id="getEduTargetOne" parameterType="map" resultType="map">
        /*getEduTargetOne*/
        SELECT
            DET.*,
            HEI.EMP_NAME_KR AS REG_EMP_NAME,
            CASE WHEN HEI.DUTY_NAME = "" THEN HEI.POSITION_NAME ELSE HEI.DUTY_NAME END AS SPOT,
            HEI.DEPT_SEQ AS REG_DEPT_SEQ,
            IF(HEI.DEPT_NAME = '', HEI.DEPT_TEAM_NAME, HEI.DEPT_NAME) AS REG_DEPT_NAME,
            HEI.DUTY_CODE AS REG_DUTY_CODE
        FROM
            CAMPUS.DJ_EDU_TARGET DET
        LEFT JOIN
            CAM_HR.DJ_EMP_INFO HEI ON DET.REG_EMP_SEQ = HEI.EMP_SEQ
        WHERE
            DET.TARGET_YEAR = #{targetYear} AND DET.REG_EMP_SEQ = #{empSeq}
    </select>

    <select id="getEduTargetPkOne" parameterType="map" resultType="map">
        /*getEduTargetPkOne*/
        SELECT
            DET.*,
            HEI.EMP_NAME_KR AS REG_EMP_NAME,
            CASE WHEN HEI.DUTY_NAME = "" THEN HEI.POSITION_NAME ELSE HEI.DUTY_NAME END AS SPOT,
            HEI.DEPT_SEQ AS REG_DEPT_SEQ,
            IF(HEI.DEPT_NAME = '', HEI.DEPT_TEAM_NAME, HEI.DEPT_NAME) AS REG_DEPT_NAME,
            HEI.DUTY_CODE AS REG_DUTY_CODE
        FROM
            CAMPUS.DJ_EDU_TARGET DET
                LEFT JOIN
            CAM_HR.DJ_EMP_INFO HEI ON DET.REG_EMP_SEQ = HEI.EMP_SEQ
        WHERE
            DET.EDU_TARGET_ID = #{eduTargetId}
    </select>

    <delete id="delPsCheck" parameterType="map">
        /*delPsCheck*/
        DELETE FROM CAM_COMMON.DJ_PS_CHECK
        WHERE
            TYPE = #{type} AND FR_KEY = #{frKey}
    </delete>

    <update id="updPsStatus" parameterType="map">
        /*updPsStatus*/
        UPDATE CAM_COMMON.DJ_PS_CHECK
        SET
            PS_STAT = 'Y'
        WHERE
            FR_KEY = #{frKey} AND TYPE = #{type}
    </update>

</mapper>